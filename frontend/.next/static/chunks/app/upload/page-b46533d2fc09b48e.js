(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[676],{3595:function(e,s,a){Promise.resolve().then(a.bind(a,7449))},2835:function(e,s,a){"use strict";a.d(s,{cn:function(){return l}});var t=a(1994),r=a(3335);function l(){for(var e=arguments.length,s=Array(e),a=0;a<e;a++)s[a]=arguments[a];return(0,r.m6)((0,t.W)(s))}},7449:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return em}});var t=a(7437),r=a(2265),l=a(4029),i=a(2595),n=a(1098);function o(e){let{variant:s="default",className:a="",children:r,...l}=e;return(0,t.jsx)("div",{role:"alert",className:"relative w-full rounded-lg border p-4 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7 ".concat({default:"bg-background text-foreground border",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}[s]," ").concat(a),...l,children:r})}function c(e){let{className:s="",children:a,...r}=e;return(0,t.jsx)("div",{className:"text-sm [&_p]:leading-relaxed ".concat(s),...r,children:a})}var d=a(1671),m=a(9322),u=a(7265),x=a(91),h=a(8736),p=a(7689),g=a(5277);let j=r.forwardRef((e,s)=>{let{className:a="",type:r="text",...l}=e;return(0,t.jsx)("input",{type:r,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 ".concat(a),ref:s,...l})});function b(e){let{className:s="",children:a,...r}=e;return(0,t.jsx)("label",{className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 ".concat(s),...r,children:a})}j.displayName="Input";let f=(0,r.createContext)(void 0);function v(e){let{value:s,onValueChange:a,children:l}=e,[i,n]=(0,r.useState)(!1);return(0,t.jsx)(f.Provider,{value:{value:s,onValueChange:a||(()=>{}),open:i,onOpenChange:n},children:(0,t.jsx)("div",{className:"relative",children:l})})}function y(e){let{children:s,className:a=""}=e,l=(0,r.useContext)(f);if(!l)throw Error("SelectTrigger must be used within a Select component");return(0,t.jsxs)("button",{className:"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 ".concat(a),onClick:()=>l.onOpenChange(!l.open),children:[s,(0,t.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",className:"h-4 w-4 opacity-50",children:(0,t.jsx)("path",{d:"M6 9L1.5 4.5H10.5L6 9Z",fill:"currentColor"})})]})}function N(e){let{placeholder:s,className:a=""}=e,l=(0,r.useContext)(f);if(!l)throw Error("SelectValue must be used within a Select component");return(0,t.jsx)("span",{className:"block truncate ".concat(a),children:l.value||s})}function w(e){let{children:s,className:a=""}=e,l=(0,r.useContext)(f);if(!l)throw Error("SelectContent must be used within a Select component");return l.open?(0,t.jsx)("div",{className:"absolute top-full left-0 z-50 w-full mt-1 max-h-60 overflow-auto rounded-md border bg-popover text-popover-foreground shadow-lg ".concat(a),children:s}):null}function k(e){let{value:s,children:a,className:l=""}=e,i=(0,r.useContext)(f);if(!i)throw Error("SelectItem must be used within a Select component");let n=i.value===s;return(0,t.jsxs)("div",{className:"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none hover:bg-accent hover:text-accent-foreground ".concat(n?"bg-accent text-accent-foreground":""," ").concat(l),onClick:()=>{i.onValueChange(s),i.onOpenChange(!1)},children:[n&&(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",className:"h-4 w-4",children:(0,t.jsx)("path",{d:"M10 3L4.5 8.5L2 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),a]})}var C=a(9397),L=a(8930);let S={glucose:{name:"Glucose",units:["mg/dL","mmol/L"],category:"metabolic"},hba1c:{name:"HbA1c",units:["%","mmol/mol"],category:"metabolic"},insulin:{name:"Insulin",units:["μU/mL","pmol/L"],category:"metabolic"},c_peptide:{name:"C-Peptide",units:["ng/mL","nmol/L"],category:"metabolic"},total_cholesterol:{name:"Total Cholesterol",units:["mg/dL","mmol/L"],category:"cardiovascular"},ldl_cholesterol:{name:"LDL Cholesterol",units:["mg/dL","mmol/L"],category:"cardiovascular"},hdl_cholesterol:{name:"HDL Cholesterol",units:["mg/dL","mmol/L"],category:"cardiovascular"},triglycerides:{name:"Triglycerides",units:["mg/dL","mmol/L"],category:"cardiovascular"},apolipoprotein_b:{name:"Apolipoprotein B",units:["mg/dL","g/L"],category:"cardiovascular"},apolipoprotein_a1:{name:"Apolipoprotein A1",units:["mg/dL","g/L"],category:"cardiovascular"},crp:{name:"C-Reactive Protein (CRP)",units:["mg/L","mg/dL"],category:"inflammatory"},esr:{name:"Erythrocyte Sedimentation Rate (ESR)",units:["mm/hr"],category:"inflammatory"},il_6:{name:"Interleukin-6 (IL-6)",units:["pg/mL","ng/L"],category:"inflammatory"},tnf_alpha:{name:"TNF-α",units:["pg/mL","ng/L"],category:"inflammatory"},creatinine:{name:"Creatinine",units:["mg/dL","μmol/L"],category:"organ"},bun:{name:"Blood Urea Nitrogen (BUN)",units:["mg/dL","mmol/L"],category:"organ"},alt:{name:"ALT (Alanine Aminotransferase)",units:["U/L"],category:"organ"},ast:{name:"AST (Aspartate Aminotransferase)",units:["U/L"],category:"organ"},ggt:{name:"GGT (Gamma-Glutamyl Transferase)",units:["U/L"],category:"organ"},alkaline_phosphatase:{name:"Alkaline Phosphatase",units:["U/L"],category:"organ"},hemoglobin:{name:"Hemoglobin",units:["g/dL","g/L"],category:"cbc"},hematocrit:{name:"Hematocrit",units:["%","L/L"],category:"cbc"},wbc:{name:"White Blood Cell Count",units:["K/μL","\xd710⁹/L"],category:"cbc"},rbc:{name:"Red Blood Cell Count",units:["M/μL","\xd710\xb9\xb2/L"],category:"cbc"},platelets:{name:"Platelet Count",units:["K/μL","\xd710⁹/L"],category:"cbc"},tsh:{name:"TSH (Thyroid Stimulating Hormone)",units:["mIU/L","μIU/mL"],category:"hormonal"},free_t4:{name:"Free T4",units:["ng/dL","pmol/L"],category:"hormonal"},free_t3:{name:"Free T3",units:["pg/mL","pmol/L"],category:"hormonal"},cortisol:{name:"Cortisol",units:["μg/dL","nmol/L"],category:"hormonal"},testosterone:{name:"Testosterone",units:["ng/dL","nmol/L"],category:"hormonal"},vitamin_d:{name:"Vitamin D (25-OH)",units:["ng/mL","nmol/L"],category:"nutritional"},vitamin_b12:{name:"Vitamin B12",units:["pg/mL","pmol/L"],category:"nutritional"},folate:{name:"Folate",units:["ng/mL","nmol/L"],category:"nutritional"},iron:{name:"Iron",units:["μg/dL","μmol/L"],category:"nutritional"},ferritin:{name:"Ferritin",units:["ng/mL","μg/L"],category:"nutritional"}},q={metabolic:"Metabolic Health",cardiovascular:"Cardiovascular Health",inflammatory:"Inflammatory Health",organ:"Organ Function",cbc:"Complete Blood Count",hormonal:"Hormonal Health",nutritional:"Nutritional Status"};function T(e){let{onSubmit:s,onCancel:a,isLoading:m=!1,showSubmitButton:u=!0,initialData:h=null}=e,[g,f]=(0,r.useState)([]),[T,F]=(0,r.useState)({}),[_,P]=(0,r.useState)("manual"),[A,Z]=(0,r.useState)("");r.useEffect(()=>{h&&Object.keys(h).length>0&&(console.debug("[BiomarkerForm] Initializing with data:",h),f(Object.entries(h).map(e=>{let[s,a]=e;return{id:s,value:a.value||0,unit:a.unit||"",date:a.date||new Date().toISOString().split("T")[0]}})))},[h]);let E=()=>{f([...g,{id:"",value:0,unit:"",date:new Date().toISOString().split("T")[0]}])},R=e=>{f(g.filter((s,a)=>a!==e))},B=(e,s,a)=>{let t=[...g];t[e]={...t[e],[s]:a},f(t),T["biomarker_".concat(e)]&&F(s=>{let a={...s};return delete a["biomarker_".concat(e)],a})},O=()=>{let e={};return g.forEach((s,a)=>{s.id||(e["biomarker_".concat(a)]="Please select a biomarker"),(!s.value||s.value<=0)&&(e["biomarker_".concat(a)]="Please enter a valid value"),s.unit||(e["biomarker_".concat(a)]="Please select a unit")}),F(e),0===Object.keys(e).length},U=e=>{let s=e.split("\n").filter(e=>e.trim());s[0].split(",").map(e=>e.trim().toLowerCase());let a=[];for(let e=1;e<s.length;e++){let t=s[e].split(",").map(e=>e.trim());if(t.length>=2){let e=t[0].toLowerCase().replace(/[^a-z0-9_]/g,"_"),s=parseFloat(t[1]),r=t[2]||"",l=t[3]||new Date().toISOString().split("T")[0];isNaN(s)||a.push({id:e,value:s,unit:r,date:l})}}f(a)},D=(()=>{let e={};return Object.entries(S).forEach(s=>{let[a,t]=s;e[t.category]||(e[t.category]=[]),e[t.category].push(a)}),e})();return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)(n.mQ,{value:_,onValueChange:P,children:[(0,t.jsxs)(n.dr,{className:"grid w-full grid-cols-2",children:[(0,t.jsxs)(n.SP,{value:"manual",className:"flex items-center gap-2",children:[(0,t.jsx)(x.Z,{className:"h-4 w-4"}),"Manual Entry"]}),(0,t.jsxs)(n.SP,{value:"upload",className:"flex items-center gap-2",children:[(0,t.jsx)(p.Z,{className:"h-4 w-4"}),"CSV Upload"]})]}),(0,t.jsxs)(n.nU,{value:"manual",className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"Enter Biomarker Values"}),(0,t.jsxs)(i.z,{onClick:E,size:"sm",className:"flex items-center gap-2",children:[(0,t.jsx)(C.Z,{className:"h-4 w-4"}),"Add Biomarker"]})]}),0===g.length?(0,t.jsx)(l.Zb,{className:"border-dashed",children:(0,t.jsx)(l.aY,{className:"pt-6",children:(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(x.Z,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-500 mb-4",children:"No biomarkers added yet"}),(0,t.jsx)(i.z,{onClick:E,variant:"outline",children:"Add Your First Biomarker"})]})})}):(0,t.jsx)("div",{className:"space-y-4",children:g.map((e,s)=>{var a;return(0,t.jsx)(l.Zb,{className:"border-l-4 border-l-blue-500",children:(0,t.jsxs)(l.aY,{className:"pt-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(b,{htmlFor:"biomarker-".concat(s),children:"Biomarker"}),(0,t.jsxs)(v,{value:e.id,onValueChange:e=>B(s,"id",e),children:[(0,t.jsx)(y,{children:(0,t.jsx)(N,{placeholder:"Select biomarker"})}),(0,t.jsx)(w,{className:"max-h-60",children:Object.entries(D).map(e=>{let[s,a]=e;return(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"px-2 py-1 text-xs font-semibold text-gray-500 bg-gray-50",children:q[s]}),a.map(e=>{var s;return(0,t.jsx)(k,{value:e,children:null===(s=S[e])||void 0===s?void 0:s.name},e)})]},s)})})]}),T["biomarker_".concat(s)]&&(0,t.jsx)("p",{className:"text-xs text-red-500 mt-1",children:T["biomarker_".concat(s)]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(b,{htmlFor:"value-".concat(s),children:"Value"}),(0,t.jsx)(j,{id:"value-".concat(s),type:"number",step:"0.01",value:e.value||"",onChange:e=>B(s,"value",parseFloat(e.target.value)),placeholder:"Enter value"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(b,{htmlFor:"unit-".concat(s),children:"Unit"}),(0,t.jsxs)(v,{value:e.unit,onValueChange:e=>B(s,"unit",e),children:[(0,t.jsx)(y,{children:(0,t.jsx)(N,{placeholder:"Select unit"})}),(0,t.jsx)(w,{children:e.id&&(null===(a=S[e.id])||void 0===a?void 0:a.units.map(e=>(0,t.jsx)(k,{value:e,children:e},e)))})]})]}),(0,t.jsx)("div",{className:"flex items-end",children:(0,t.jsx)(i.z,{type:"button",variant:"outline",size:"sm",onClick:()=>R(s),className:"text-red-600 hover:text-red-700","aria-label":"Remove biomarker",children:(0,t.jsx)(L.Z,{className:"h-4 w-4"})})})]}),(0,t.jsxs)("div",{className:"mt-3",children:[(0,t.jsx)(b,{htmlFor:"date-".concat(s),children:"Date (Optional)"}),(0,t.jsx)(j,{id:"date-".concat(s),type:"date",value:e.date||"",onChange:e=>B(s,"date",e.target.value),className:"max-w-xs"})]})]})},s)})})]}),(0,t.jsx)(n.nU,{value:"upload",className:"space-y-4",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Upload CSV File"}),(0,t.jsx)(l.Zb,{className:"border-dashed",children:(0,t.jsx)(l.aY,{className:"pt-6",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(p.Z,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:"Upload a CSV file with your biomarker data. Format: biomarker_id, value, unit, date"}),(0,t.jsx)("input",{type:"file",accept:".csv",onChange:e=>{var s;let a=null===(s=e.target.files)||void 0===s?void 0:s[0];if(!a)return;let t=new FileReader;t.onload=e=>{var s;let a=null===(s=e.target)||void 0===s?void 0:s.result;Z(a),U(a)},t.readAsText(a)},className:"hidden",id:"csv-upload"}),(0,t.jsx)(b,{htmlFor:"csv-upload",children:(0,t.jsx)(i.z,{variant:"outline",onClick:()=>{var e;return null===(e=document.getElementById("csv-upload"))||void 0===e?void 0:e.click()},children:"Choose CSV File"})})]})})}),A&&(0,t.jsxs)(o,{children:[(0,t.jsx)(d.Z,{className:"h-4 w-4"}),(0,t.jsxs)(c,{children:["CSV file processed. ",g.length," biomarkers loaded."]})]})]})})]}),u&&(0,t.jsxs)("div",{className:"flex justify-between pt-6",children:[(0,t.jsx)(i.z,{variant:"outline",onClick:a,disabled:m,children:"Cancel"}),(0,t.jsx)(i.z,{onClick:()=>{O()&&s(g.reduce((e,s)=>(e[s.id]={value:s.value,unit:s.unit,date:s.date},e),{}))},disabled:m||0===g.length,className:"bg-blue-600 hover:bg-blue-700",children:m?"Processing...":"Submit ".concat(g.length," Biomarkers")})]})]})}function F(e){let{value:s=[0],onValueChange:a,min:r=0,max:l=100,step:i=1,className:n=""}=e;return(0,t.jsx)("div",{className:"relative flex w-full touch-none select-none items-center ".concat(n),children:(0,t.jsx)("input",{type:"range",min:r,max:l,step:i,value:s[0],onChange:e=>{a&&a([parseInt(e.target.value)])},className:"w-full h-2 bg-secondary rounded-lg appearance-none cursor-pointer"})})}function _(e){let{className:s="",onCheckedChange:a,...r}=e;return(0,t.jsx)("input",{type:"checkbox",className:"h-4 w-4 rounded border border-primary text-primary focus:ring-2 focus:ring-ring focus:ring-offset-2 ".concat(s),onChange:e=>{a&&a(e.target.checked)},...r})}let P=r.forwardRef((e,s)=>{let{className:a="",...r}=e;return(0,t.jsx)("textarea",{className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 ".concat(a),ref:s,...r})});P.displayName="Textarea";var A=a(1236),Z=a(1817);function E(e){let{onSubmit:s,onCancel:a,initialData:n={},isLoading:o=!1}=e,[c,m]=(0,r.useState)([]),[u,x]=(0,r.useState)(n),[h,p]=(0,r.useState)(0),[g,f]=(0,r.useState)({}),[C,L]=(0,r.useState)(!1),[S,q]=(0,r.useState)(!0),T=Math.ceil(c.length/5);(0,r.useEffect)(()=>{E()},[]);let E=async()=>{try{m([{id:"full_name",section:"demographics",question:"Full Name",type:"text",required:!0},{id:"email_address",section:"demographics",question:"Email Address",type:"email",required:!0},{id:"phone_number",section:"demographics",question:"Phone Number",type:"phone",required:!0},{id:"country",section:"demographics",question:"Country",type:"dropdown",options:["United Kingdom","United States","Canada","Australia","Other"],required:!0},{id:"state_province",section:"demographics",question:"State/Province",type:"text",required:!1},{id:"date_of_birth",section:"demographics",question:"Date of Birth",type:"date",required:!0},{id:"biological_sex",section:"demographics",question:"Biological Sex",type:"dropdown",options:["Male","Female","Intersex"],required:!0},{id:"height",section:"demographics",question:"Height",type:"group",fields:[{label:"Feet",type:"number",min:3,max:8},{label:"Inches",type:"number",min:0,max:11}],alternativeUnit:{label:"Height (cm)",type:"number",min:100,max:250},required:!0},{id:"weight",section:"demographics",question:"Weight",type:"number",label:"Weight (lbs)",alternativeUnit:{label:"Weight (kg)",type:"number",min:30,max:300},required:!0},{id:"sleep_hours_nightly",section:"lifestyle",question:"How many hours of sleep do you typically get per night?",type:"dropdown",options:["Less than 5 hours","5-6 hours","7-8 hours","9+ hours"],required:!0},{id:"sleep_quality_rating",section:"lifestyle",question:"Rate your sleep quality (1-10)",type:"slider",min:1,max:10,labels:{1:"Wake up exhausted",5:"Somewhat rested",10:"Always refreshed"},required:!0},{id:"alcohol_drinks_weekly",section:"lifestyle",question:"How many alcoholic drinks do you consume per week?",type:"dropdown",options:["None","1-3 drinks","4-7 drinks","8-14 drinks","15+ drinks"],helpText:"1 drink = 12oz beer, 5oz wine, or 1.5oz spirits",required:!0},{id:"tobacco_use",section:"lifestyle",question:"Do you currently use tobacco products?",type:"dropdown",options:["Never used","Former user quit >1 year","Former user quit <1 year","Occasional use","Daily use"],required:!0},{id:"stress_level_rating",section:"lifestyle",question:"Rate your average stress level (1-10)",type:"slider",min:1,max:10,labels:{1:"Very low stress",5:"Moderate stress",10:"Overwhelming stress"},required:!0},{id:"vigorous_exercise_days",section:"lifestyle",question:"How many days per week do you do vigorous exercise (20+ min)?",type:"dropdown",options:["0 days","1 day","2 days","3 days","4+ days"],helpText:"Vigorous = hard breathing and sweating",required:!0},{id:"current_medications",section:"medical_history",question:"Are you currently taking any prescription medications?",type:"dropdown",options:["None","1-2 medications","3-5 medications","6+ medications","Prefer not to say"],required:!0},{id:"long_term_medications",section:"medical_history",question:"Are you currently taking any of the following long-term medications?",type:"checkbox",options:["None","Corticosteroids","Atypical antipsychotics","HIV/AIDS treatments"],required:!0,helpText:"These medications can affect cardiovascular risk assessment"},{id:"chronic_conditions",section:"medical_history",question:"Do you have any diagnosed chronic conditions?",type:"checkbox",options:["None","High blood pressure","High cholesterol","Diabetes Type 1","Diabetes Type 2","Heart disease","Thyroid disorder","Autoimmune condition","Liver disease","Kidney disease","Other"],allowOther:!0,required:!0},{id:"medical_conditions",section:"medical_history",question:"Have you ever been diagnosed with any of the following medical conditions?",type:"checkbox",options:["None","Atrial fibrillation","Rheumatoid arthritis","Systemic lupus erythematosus (SLE)"],required:!0,helpText:"These conditions can affect cardiovascular risk assessment"},{id:"current_symptoms",section:"symptoms",question:"Do you have any current symptoms affecting your daily life?",type:"checkbox",options:["None","Fatigue","Brain fog","Joint pain","Digestive issues","Sleep problems","Mood changes","Other"],allowOther:!0,required:!0},{id:"regular_migraines",section:"symptoms",question:"Do you suffer from regular migraines?",type:"dropdown",options:["Yes","No","Not sure"],required:!0,helpText:"Migraines can be associated with cardiovascular risk factors"}]),q(!1)}catch(e){console.error("Failed to load questions:",e),q(!1)}},R=()=>{let e=5*h;return c.slice(e,e+5)},B=(e,s)=>{x(a=>({...a,[e]:s})),g[e]&&f(s=>{let a={...s};return delete a[e],a})},O=()=>{let e=R(),s={};return e.forEach(e=>{e.required&&(!u[e.id]||""===u[e.id])&&(s[e.id]="This field is required")}),f(s),0===Object.keys(s).length},U=async()=>{if(O()){L(!0);try{await s(u)}catch(e){console.error("Failed to submit questionnaire:",e)}finally{L(!1)}}},D=e=>{var s,a,r;let l=u[e.id],i=g[e.id];switch(e.type){case"text":case"email":case"phone":case"date":return(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(b,{htmlFor:e.id,className:"text-sm font-medium",children:[e.question,e.required&&(0,t.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,t.jsx)(j,{id:e.id,type:e.type,value:l||"",onChange:s=>B(e.id,s.target.value),className:i?"border-red-500":""}),e.helpText&&(0,t.jsx)("p",{className:"text-xs text-gray-500",children:e.helpText}),i&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:i})]},e.id);case"number":return(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(b,{htmlFor:e.id,className:"text-sm font-medium",children:[e.question,e.required&&(0,t.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,t.jsx)(j,{id:e.id,type:"number",min:e.min,max:e.max,value:l||"",onChange:s=>B(e.id,parseFloat(s.target.value)),className:i?"border-red-500":""}),e.helpText&&(0,t.jsx)("p",{className:"text-xs text-gray-500",children:e.helpText}),i&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:i})]},e.id);case"dropdown":return(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(b,{htmlFor:e.id,className:"text-sm font-medium",children:[e.question,e.required&&(0,t.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,t.jsxs)(v,{value:l||"",onValueChange:s=>B(e.id,s),children:[(0,t.jsx)(y,{className:i?"border-red-500":"",children:(0,t.jsx)(N,{placeholder:"Select an option"})}),(0,t.jsx)(w,{children:null===(s=e.options)||void 0===s?void 0:s.map(e=>(0,t.jsx)(k,{value:e,children:e},e))})]}),e.helpText&&(0,t.jsx)("p",{className:"text-xs text-gray-500",children:e.helpText}),i&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:i})]},e.id);case"slider":return(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(b,{htmlFor:e.id,className:"text-sm font-medium",children:[e.question,e.required&&(0,t.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,t.jsxs)("div",{className:"px-3",children:[(0,t.jsx)(F,{min:e.min||1,max:e.max||10,step:1,value:l||e.min||1,onValueChange:s=>B(e.id,s),className:"w-full"}),(0,t.jsx)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:e.labels&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{children:e.labels[String(e.min||1)]}),(0,t.jsx)("span",{children:e.labels[String(e.max||10)]})]})}),(0,t.jsx)("div",{className:"text-center mt-2",children:(0,t.jsx)("span",{className:"text-lg font-semibold",children:l||e.min||1})})]}),e.helpText&&(0,t.jsx)("p",{className:"text-xs text-gray-500",children:e.helpText}),i&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:i})]},e.id);case"checkbox":return(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(b,{className:"text-sm font-medium",children:[e.question,e.required&&(0,t.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,t.jsx)("div",{className:"space-y-2",children:null===(a=e.options)||void 0===a?void 0:a.map(s=>(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(_,{id:"".concat(e.id,"-").concat(s),checked:Array.isArray(l)&&l.includes(s),onCheckedChange:a=>{let t=Array.isArray(l)?l:[];a?B(e.id,[...t,s]):B(e.id,t.filter(e=>e!==s))}}),(0,t.jsx)(b,{htmlFor:"".concat(e.id,"-").concat(s),className:"text-sm",children:s})]},s))}),e.helpText&&(0,t.jsx)("p",{className:"text-xs text-gray-500",children:e.helpText}),i&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:i})]},e.id);case"group":return(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(b,{className:"text-sm font-medium",children:[e.question,e.required&&(0,t.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:null===(r=e.fields)||void 0===r?void 0:r.map(s=>(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)(b,{htmlFor:"".concat(e.id,"-").concat(s.label),className:"text-xs",children:s.label}),(0,t.jsx)(j,{id:"".concat(e.id,"-").concat(s.label),type:s.type,min:s.min,max:s.max,value:(null==l?void 0:l[s.label])||"",onChange:a=>{let t={...l,[s.label]:"number"===s.type?parseFloat(a.target.value):a.target.value};B(e.id,t)}})]},s.label))}),e.helpText&&(0,t.jsx)("p",{className:"text-xs text-gray-500",children:e.helpText}),i&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:i})]},e.id);default:return(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(b,{htmlFor:e.id,className:"text-sm font-medium",children:[e.question,e.required&&(0,t.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,t.jsx)(P,{id:e.id,value:l||"",onChange:s=>B(e.id,s.target.value),className:i?"border-red-500":""}),e.helpText&&(0,t.jsx)("p",{className:"text-xs text-gray-500",children:e.helpText}),i&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:i})]},e.id)}};return S?(0,t.jsxs)("div",{className:"flex items-center justify-center p-8",children:[(0,t.jsx)(Z.Z,{className:"h-8 w-8 animate-spin"}),(0,t.jsx)("span",{className:"ml-2",children:"Loading questionnaire..."})]}):(R(),(0,t.jsx)("div",{className:"max-w-4xl mx-auto p-6",children:(0,t.jsxs)(l.Zb,{children:[(0,t.jsxs)(l.Ol,{children:[(0,t.jsxs)(l.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(d.Z,{className:"h-5 w-5 text-green-500"}),"Health Assessment Questionnaire"]}),(0,t.jsxs)(l.SZ,{children:["Please complete all required fields to get personalized health insights. Step ",h+1," of ",T]}),(0,t.jsx)(A.E,{value:(h+1)/T*100,className:"w-full"})]}),(0,t.jsxs)(l.aY,{className:"space-y-6",children:[Object.entries(c.reduce((e,s)=>(e[s.section]||(e[s.section]=[]),e[s.section].push(s),e),{})).map(e=>{let[s,a]=e;return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 capitalize",children:s.replace(/_/g," ")}),(0,t.jsx)("div",{className:"space-y-4 pl-4",children:a.map(D)})]},s)}),(0,t.jsxs)("div",{className:"flex justify-between pt-6",children:[(0,t.jsx)(i.z,{variant:"outline",onClick:0===h?a:()=>{p(e=>Math.max(e-1,0))},disabled:C,children:0===h?"Cancel":"Previous"}),(0,t.jsx)("div",{className:"flex gap-2",children:h<T-1?(0,t.jsx)(i.z,{onClick:()=>{O()&&p(e=>Math.min(e+1,T-1))},disabled:C,children:"Next"}):(0,t.jsx)(i.z,{onClick:U,disabled:C,className:"bg-green-600 hover:bg-green-700",children:C?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Z.Z,{className:"h-4 w-4 animate-spin mr-2"}),"Submitting..."]}):"Complete Assessment"})})]})]})]})}))}var R=a(5725),B=a(2489),O=a(3276);function U(e){let{onFileParse:s,onError:a,maxSize:n=10485760,acceptedTypes:o=["application/pdf","text/plain","application/json","text/csv"],disabled:c=!1,isParsing:d=!1}=e,[u,x]=(0,r.useState)(!1),[g,j]=(0,r.useState)(null),[b,f]=(0,r.useState)(null),v=(0,r.useCallback)(e=>{let s=e[0];s&&(j(null),f(s))},[]),y=()=>{f(null),j(null)},N=(0,r.useCallback)(e=>{var s,t;let r=e[0];if((null===(s=r.errors[0])||void 0===s?void 0:s.code)==="file-too-large"){let e="File too large. Maximum size is ".concat(Math.round(n/1024/1024),"MB");j(e),null==a||a(e)}else if((null===(t=r.errors[0])||void 0===t?void 0:t.code)==="file-invalid-type"){let e="Invalid file type. Accepted types: ".concat(o.join(", "));j(e),null==a||a(e)}},[n,o,a]),{getRootProps:w,getInputProps:k,isDragReject:C}=(0,R.uI)({onDrop:v,onDropRejected:N,accept:o.reduce((e,s)=>(e[s]=[],e),{}),maxSize:n,multiple:!1,disabled:c||d});return(0,t.jsx)(l.Zb,{className:"w-full",children:(0,t.jsxs)(l.aY,{className:"p-6",children:[b?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"p-2 bg-blue-100 rounded",children:(0,t.jsx)(h.Z,{className:"h-5 w-5 text-blue-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-gray-900",children:b.name}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:(e=>{if(0===e)return"0 Bytes";let s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(2))+" "+["Bytes","KB","MB","GB"][s]})(b.size)})]})]}),(0,t.jsx)(i.z,{variant:"ghost",size:"sm",onClick:y,disabled:d,className:"text-gray-400 hover:text-gray-600",children:(0,t.jsx)(B.Z,{className:"h-4 w-4"})})]}),(0,t.jsxs)("div",{className:"flex space-x-3",children:[(0,t.jsx)(i.z,{onClick:()=>{b&&s(b)},disabled:d,className:"flex-1",children:d?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Parsing..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(O.Z,{className:"h-4 w-4 mr-2"}),"Parse File"]})}),(0,t.jsxs)(i.z,{variant:"outline",onClick:y,disabled:d,children:[(0,t.jsx)(B.Z,{className:"h-4 w-4 mr-2"}),"Remove"]})]})]}):(0,t.jsxs)("div",{...w(),className:"\n              border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors\n              ".concat(u?"border-primary bg-primary/5":"border-border hover:border-primary/50","\n              ").concat(C?"border-destructive bg-destructive/5":"","\n              ").concat(c||d?"opacity-50 cursor-not-allowed":"","\n            "),onMouseEnter:()=>x(!0),onMouseLeave:()=>x(!1),children:[(0,t.jsx)("input",{...k()}),(0,t.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,t.jsx)("div",{className:"p-3 bg-primary/10 rounded-full",children:(0,t.jsx)(p.Z,{className:"h-8 w-8 text-primary"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-foreground",children:"Drop your lab report here"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"or click to browse files"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-xs text-muted-foreground",children:[(0,t.jsx)(h.Z,{className:"h-4 w-4"}),(0,t.jsxs)("span",{children:["PDF, TXT, JSON, CSV up to ",Math.round(n/1024/1024),"MB"]})]})]})]}),g&&(0,t.jsxs)("div",{className:"mt-4 flex items-center space-x-2 text-destructive text-sm",children:[(0,t.jsx)(m.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:g})]})]})})}var D=a(8867);function z(e){let{onTextSubmit:s,onError:a,disabled:n=!1,placeholder:o="Paste your lab results here...\n\nExample:\nTotal Cholesterol: 180 mg/dL\nHDL Cholesterol: 45 mg/dL\nLDL Cholesterol: 110 mg/dL\nTriglycerides: 125 mg/dL"}=e,[c,d]=(0,r.useState)(""),[u,x]=(0,r.useState)(null),h=async()=>{try{let e=await navigator.clipboard.readText();d(e),x(null)}catch(s){let e="Unable to access clipboard. Please paste manually";x(e),null==a||a(e)}};return(0,t.jsxs)(l.Zb,{className:"w-full",children:[(0,t.jsx)(l.Ol,{children:(0,t.jsxs)(l.ll,{className:"flex items-center space-x-2",children:[(0,t.jsx)(D.Z,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:"Paste Lab Results"})]})}),(0,t.jsxs)(l.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(P,{value:c,onChange:e=>{d(e.target.value),x(null)},placeholder:o,disabled:n,className:"min-h-[200px] resize-none"}),(0,t.jsxs)("div",{className:"flex justify-between items-center text-xs text-muted-foreground",children:[(0,t.jsxs)("span",{children:[c.length," characters"]}),(0,t.jsx)("span",{children:"Minimum 10 characters required"})]})]}),u&&(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-destructive text-sm",children:[(0,t.jsx)(m.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:u})]}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)(i.z,{onClick:()=>{let e=c.trim();if(!e){let e="Please paste some lab results text before submitting";x(e),null==a||a(e);return}if(e.length<10){let e="Text appears too short. Please paste more detailed lab results";x(e),null==a||a(e);return}x(null),s(e)},disabled:n||!c.trim(),className:"flex-1",children:"Parse Lab Results"}),(0,t.jsx)(i.z,{onClick:h,variant:"outline",disabled:n,children:"Paste from Clipboard"}),(0,t.jsx)(i.z,{onClick:()=>{d(""),x(null)},variant:"outline",disabled:n||!c,children:"Clear"})]})]})]})}var H=a(1875),I=a(2835);let M=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{className:"relative w-full overflow-auto",children:(0,t.jsx)("table",{ref:s,className:(0,I.cn)("w-full caption-bottom text-sm",a),...r})})});M.displayName="Table";let V=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("thead",{ref:s,className:(0,I.cn)("[&_tr]:border-b",a),...r})});V.displayName="TableHeader";let Y=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("tbody",{ref:s,className:(0,I.cn)("[&_tr:last-child]:border-0",a),...r})});Y.displayName="TableBody",r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("tfoot",{ref:s,className:(0,I.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...r})}).displayName="TableFooter";let Q=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("tr",{ref:s,className:(0,I.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...r})});Q.displayName="TableRow";let G=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("th",{ref:s,className:(0,I.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...r})});G.displayName="TableHead";let W=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("td",{ref:s,className:(0,I.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...r})});W.displayName="TableCell",r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("caption",{ref:s,className:(0,I.cn)("mt-4 text-sm text-muted-foreground",a),...r})}).displayName="TableCaption";var K=a(5868),J=a(401),X=a(3229);let $=["mg/dL","mmol/L","ng/mL","pg/mL","IU/mL","U/L","g/dL","%","cells/μL","mg/L","μg/dL","mEq/L","ng/dL","pmol/L"],ee=["Total Cholesterol","HDL Cholesterol","LDL Cholesterol","Triglycerides","Glucose","HbA1c","Insulin","C-Reactive Protein","ESR","Ferritin","Vitamin D","B12","Folate","TSH","T4","T3","Creatinine","BUN","ALT","AST","GGT","ALP","Bilirubin","Albumin","Hemoglobin","Hematocrit","WBC","RBC","Platelets","Sodium","Potassium","Chloride","CO2","Calcium","Phosphorus","Magnesium"];function es(e){let{biomarker:s,isOpen:a,onSave:n,onCancel:o}=e,[c,d]=(0,r.useState)({name:"",value:"",unit:"",status:"edited"}),[u,x]=(0,r.useState)({});(0,r.useEffect)(()=>{s&&(d({name:s.name,value:s.value.toString(),unit:s.unit,status:s.status||"edited"}),x({}))},[s]);let h=()=>{let e={};if(c.name.trim()||(e.name="Biomarker name is required"),c.value.trim()){let s=parseFloat(c.value);isNaN(s)?e.value="Value must be a valid number":s<0&&(e.value="Value must be positive")}else e.value="Value is required";return c.unit.trim()||(e.unit="Unit is required"),x(e),0===Object.keys(e).length};return a&&s?(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,t.jsxs)(l.Zb,{className:"w-full max-w-md max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)(l.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-4",children:[(0,t.jsx)(l.ll,{children:"Edit Biomarker"}),(0,t.jsx)(i.z,{variant:"ghost",size:"sm",onClick:o,children:(0,t.jsx)(B.Z,{className:"h-4 w-4"})})]}),(0,t.jsxs)(l.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(b,{htmlFor:"name",children:"Biomarker Name"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(v,{onValueChange:e=>{d(s=>({...s,name:e}))},value:c.name,children:[(0,t.jsx)(y,{children:(0,t.jsx)(N,{placeholder:"Select or type biomarker name"})}),(0,t.jsx)(w,{children:ee.map(e=>(0,t.jsx)(k,{value:e,children:e},e))})]}),(0,t.jsx)(j,{id:"name",value:c.name,onChange:e=>d(s=>({...s,name:e.target.value})),placeholder:"Enter biomarker name",className:u.name?"border-red-500":""})]}),u.name&&(0,t.jsxs)("div",{className:"flex items-center space-x-1 text-destructive text-sm",children:[(0,t.jsx)(m.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:u.name})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(b,{htmlFor:"value",children:"Value"}),(0,t.jsx)(j,{id:"value",type:"number",step:"any",value:c.value,onChange:e=>d(s=>({...s,value:e.target.value})),placeholder:"Enter value",className:u.value?"border-red-500":""}),u.value&&(0,t.jsxs)("div",{className:"flex items-center space-x-1 text-destructive text-sm",children:[(0,t.jsx)(m.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:u.value})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(b,{htmlFor:"unit",children:"Unit"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(v,{onValueChange:e=>d(s=>({...s,unit:e})),value:c.unit,children:[(0,t.jsx)(y,{children:(0,t.jsx)(N,{placeholder:"Select unit"})}),(0,t.jsx)(w,{children:$.map(e=>(0,t.jsx)(k,{value:e,children:e},e))})]}),(0,t.jsx)(j,{id:"unit",value:c.unit,onChange:e=>d(s=>({...s,unit:e.target.value})),placeholder:"Enter unit",className:u.unit?"border-red-500":""})]}),u.unit&&(0,t.jsxs)("div",{className:"flex items-center space-x-1 text-destructive text-sm",children:[(0,t.jsx)(m.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:u.unit})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(b,{children:"Status"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(H.C,{variant:"default",children:"Edited"}),(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"This biomarker has been modified from the original"})]})]}),(0,t.jsxs)("div",{className:"flex space-x-2 pt-4",children:[(0,t.jsxs)(i.z,{onClick:()=>{if(!h())return;let e=parseFloat(c.value);n({name:c.name.trim(),value:isNaN(e)?c.value:e,unit:c.unit.trim(),status:"edited"})},className:"flex-1",children:[(0,t.jsx)(X.Z,{className:"h-4 w-4 mr-2"}),"Save Changes"]}),(0,t.jsx)(i.z,{onClick:o,variant:"outline",className:"flex-1",children:"Cancel"})]})]})]})}):null}function ea(e){let{biomarkers:s,onBiomarkerEdit:a,onConfirmAll:n,isLoading:o=!1,error:c=null}=e,[d,u]=(0,r.useState)(null),x=e=>{switch(e){case"raw":default:return(0,t.jsx)(H.C,{variant:"secondary",children:"Raw"});case"edited":return(0,t.jsx)(H.C,{variant:"default",children:"Edited"});case"confirmed":return(0,t.jsx)(H.C,{variant:"outline",className:"text-[hsl(var(--status-excellent))] border-[hsl(var(--status-excellent))]",children:"Confirmed"})}},h=e=>{switch(e){case"Low":return(0,t.jsx)(H.C,{variant:"outline",className:"text-blue-600 border-blue-600",children:"Low"});case"Normal":return(0,t.jsx)(H.C,{variant:"outline",className:"text-green-600 border-green-600",children:"Normal"});case"High":return(0,t.jsx)(H.C,{variant:"outline",className:"text-red-600 border-red-600",children:"High"});default:return(0,t.jsx)(H.C,{variant:"secondary",children:"Unknown"})}},p=e=>{u(e)},g=s.every(e=>"confirmed"===e.status),j=s.some(e=>"confirmed"!==e.status);return c?(0,t.jsx)(l.Zb,{className:"w-full",children:(0,t.jsx)(l.aY,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-destructive",children:[(0,t.jsx)(m.Z,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:c})]})})}):0===s.length?(0,t.jsx)(l.Zb,{className:"w-full",children:(0,t.jsx)(l.aY,{className:"p-6 text-center text-muted-foreground",children:"No biomarkers found. Please upload or paste lab results to get started."})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(l.Zb,{className:"w-full",children:[(0,t.jsx)(l.Ol,{children:(0,t.jsxs)(l.ll,{className:"flex items-center justify-between",children:[(0,t.jsxs)("span",{children:["Parsed Biomarkers (",s.length,")"]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[j&&(0,t.jsx)(H.C,{variant:"outline",className:"text-[hsl(var(--status-fair))] border-[hsl(var(--status-fair))]",children:"Review Required"}),g&&(0,t.jsx)(H.C,{variant:"outline",className:"text-[hsl(var(--status-excellent))] border-[hsl(var(--status-excellent))]",children:"All Confirmed"})]})]})}),(0,t.jsxs)(l.aY,{children:[(0,t.jsx)("div",{className:"rounded-md border",children:(0,t.jsxs)(M,{children:[(0,t.jsx)(V,{children:(0,t.jsxs)(Q,{children:[(0,t.jsx)(G,{children:"Biomarker"}),(0,t.jsx)(G,{children:"Value"}),(0,t.jsx)(G,{children:"Unit"}),(0,t.jsx)(G,{children:"Reference Range"}),(0,t.jsx)(G,{children:"Health Status"}),(0,t.jsx)(G,{children:"Status"}),(0,t.jsx)(G,{className:"w-[100px]",children:"Actions"})]})}),(0,t.jsx)(Y,{children:s.map((e,s)=>(0,t.jsxs)(Q,{children:[(0,t.jsx)(W,{className:"font-medium",children:e.name}),(0,t.jsx)(W,{children:"number"==typeof e.value?e.value.toFixed(2):e.value}),(0,t.jsx)(W,{children:e.unit}),(0,t.jsx)(W,{children:e.reference||"-"}),(0,t.jsx)(W,{children:h(e.healthStatus)}),(0,t.jsx)(W,{children:x(e.status)}),(0,t.jsx)(W,{children:(0,t.jsx)(i.z,{variant:"outline",size:"sm",onClick:()=>p(s),disabled:o,children:(0,t.jsx)(K.Z,{className:"h-4 w-4"})})})]},s))})]})}),(0,t.jsx)("div",{className:"mt-4 flex justify-end",children:(0,t.jsx)(i.z,{onClick:n,disabled:o||0===s.length,className:"min-w-[120px]",children:o?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(J.Z,{className:"h-4 w-4 mr-2"}),"Confirm All"]})})})]})]}),(0,t.jsx)(es,{biomarker:null!==d?s[d]:null,isOpen:null!==d,onSave:e=>{null!==d&&(a(d,e),u(null))},onCancel:()=>{u(null)}})]})}var et=a(2430),er=a(9625);let el=(0,er.Ue)((e,s)=>({status:"idle",parsedData:[],error:null,analysisId:null,sourceMetadata:null,setStatus:s=>e({status:s}),setParsedData:s=>e({parsedData:s}),updateBiomarker:(a,t)=>{let{parsedData:r}=s(),l=[...r];l[a]={...t,status:"edited"},e({parsedData:l})},setError:s=>e({error:s}),setAnalysisId:s=>e({analysisId:s}),setSourceMetadata:s=>e({sourceMetadata:s}),startUpload:()=>e({status:"uploading",error:null}),startParsing:()=>e({status:"parsing",error:null}),setParsedResults:(s,a,t)=>{e({parsedData:s.map(e=>({...e,status:"raw"})),analysisId:a,sourceMetadata:t,status:"ready",error:null})},confirmAll:()=>{let{parsedData:a}=s();e({parsedData:a.map(e=>({...e,status:"confirmed"})),status:"confirmed"})},reset:()=>e({status:"idle",parsedData:[],error:null,analysisId:null,sourceMetadata:null}),hasUnconfirmedBiomarkers:()=>{let{parsedData:e}=s();return e.some(e=>"confirmed"!==e.status)},allBiomarkersConfirmed:()=>{let{parsedData:e}=s();return e.length>0&&e.every(e=>"confirmed"===e.status)},getBiomarkersByStatus:e=>{let{parsedData:a}=s();return a.filter(s=>s.status===e)}})),ei=()=>el(e=>e.status),en=()=>el(e=>e.parsedData);(0,er.Ue)()((e,s)=>({...el.getInitialState(),reset:()=>{localStorage.removeItem("upload-store"),el.getState().reset()},setParsedResults:(e,a,t)=>{el.getState().setParsedResults(e,a,t);let r=s();localStorage.setItem("upload-store",JSON.stringify({parsedData:r.parsedData,analysisId:r.analysisId,sourceMetadata:r.sourceMetadata,status:r.status}))}}));var eo=a(1770);let ec=a(5566).env.NEXT_PUBLIC_API_URL||"http://localhost:8000";var ed=a(9376);function em(){var e;let[s,a]=(0,r.useState)("upload"),[i,j]=(0,r.useState)(!1),[b,f]=(0,r.useState)(null),[v,y]=(0,r.useState)(!1),{startAnalysis:N,isLoading:w}=(0,et._)(),k=(0,ed.useRouter)(),C=ei(),L=en(),{setParsedResults:S,updateBiomarker:q,confirmAll:F,setError:_}=el(),P=function(){let e=(0,eo.D)({mutationFn:async e=>{let{file:s,text:a}=e;if(!s&&!a)throw Error("Either file or text must be provided");let t=new FormData;s&&t.append("file",s),a&&t.append("text_content",a);let r=await fetch("".concat(ec,"/api/upload/parse"),{method:"POST",body:t});if(!r.ok)throw Error((await r.json().catch(()=>({}))).detail||"HTTP ".concat(r.status,": ").concat(r.statusText));let l=await r.json();if(!l.success)throw Error(l.message||"Parsing failed");return l},onError:e=>{console.error("Parse upload error:",e)}});return{data:e.data,error:e.error,isLoading:e.isPending,isSuccess:e.isSuccess,isError:e.isError,mutate:e.mutate,reset:e.reset}}(),A=async e=>{_(null),P.mutate({file:e})},Z=async e=>{_(null),P.mutate({text:e})},R=async()=>{try{F(),y(!0),setTimeout(()=>{k.push("/results")},2e3)}catch(e){console.error("Confirmation failed:",e),_({code:"CONFIRMATION_FAILED",message:"Failed to confirm biomarkers"})}};(0,r.useEffect)(()=>{if(P.isSuccess&&P.data){console.debug("[UploadPage] Parse upload successful:",P.data);let{parsed_data:e}=P.data;console.debug("[UploadPage] Setting parsed results:",e.biomarkers),S(e.biomarkers,P.data.analysis_id,e.metadata)}else P.isError&&P.error&&(console.error("[UploadPage] Parse upload failed:",P.error),_({code:"PARSE_ERROR",message:P.error.message||"Failed to parse upload"}))},[P.isSuccess,P.isError,P.data,P.error,S,_]);let B=async e=>{j(!0),f(null);try{await N({biomarkers:e,user:{age:35,sex:"male",height:180,weight:75},questionnaire:null}),y(!0),setTimeout(()=>{k.push("/results")},2e3)}catch(e){console.error("Analysis failed:",e),f("Failed to start analysis. Please try again.")}finally{j(!1)}},O=async e=>{j(!0),f(null);try{await N({biomarkers:{},user:{age:35,sex:"male",height:180,weight:75},questionnaire:e}),y(!0),setTimeout(()=>{k.push("/results")},2e3)}catch(e){console.error("Analysis failed:",e),f("Failed to start analysis. Please try again.")}finally{j(!1)}},D=async e=>{console.debug("[UploadPage] Combined submit called with:",e),j(!0),f(null);try{let s={biomarkers:e.biomarkers,user:{age:35,sex:"male",height:180,weight:75},questionnaire:e.questionnaire};console.debug("[UploadPage] Starting analysis with payload:",s),await N(s),y(!0),setTimeout(()=>{k.push("/results")},2e3)}catch(e){console.error("[UploadPage] Analysis failed:",e),f("Failed to start analysis. Please try again.")}finally{j(!1)}};return v?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,t.jsx)(l.Zb,{className:"w-full max-w-md",children:(0,t.jsx)(l.aY,{className:"pt-6",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(d.Z,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Analysis Started!"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:"Your health analysis is being processed. You'll be redirected to your results shortly."}),(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-500 mx-auto"})]})})})}):(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,t.jsxs)("div",{className:"container mx-auto px-4 max-w-6xl",children:[(0,t.jsxs)("div",{className:"text-center mb-8",children:[(0,t.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Health Analysis Upload"}),(0,t.jsx)("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Upload your biomarker data or complete our health questionnaire to get personalized AI-powered health insights."})]}),b&&(0,t.jsxs)(o,{className:"mb-6 border-red-200 bg-red-50",children:[(0,t.jsx)(m.Z,{className:"h-4 w-4 text-red-600"}),(0,t.jsx)(c,{className:"text-red-800",children:b})]}),(0,t.jsxs)(n.mQ,{value:s,onValueChange:a,className:"w-full",children:[(0,t.jsxs)(n.dr,{className:"grid w-full grid-cols-4 mb-8",children:[(0,t.jsxs)(n.SP,{value:"upload",className:"flex items-center gap-2",children:[(0,t.jsx)(u.Z,{className:"h-4 w-4"}),"Upload & Parse"]}),(0,t.jsxs)(n.SP,{value:"biomarkers",className:"flex items-center gap-2",children:[(0,t.jsx)(x.Z,{className:"h-4 w-4"}),"Manual Entry"]}),(0,t.jsxs)(n.SP,{value:"questionnaire",className:"flex items-center gap-2",children:[(0,t.jsx)(h.Z,{className:"h-4 w-4"}),"Questionnaire"]}),(0,t.jsxs)(n.SP,{value:"combined",className:"flex items-center gap-2",children:[(0,t.jsx)(p.Z,{className:"h-4 w-4"}),"Combined"]})]}),(0,t.jsx)(n.nU,{value:"upload",children:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[(0,t.jsx)(u.Z,{className:"h-5 w-5"}),"Upload Lab Report"]}),(0,t.jsx)(U,{onFileParse:A,onError:e=>_({code:"UPLOAD_ERROR",message:e}),disabled:P.isLoading,isParsing:P.isLoading})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[(0,t.jsx)(g.Z,{className:"h-5 w-5"}),"Paste Lab Results"]}),(0,t.jsx)(z,{onTextSubmit:Z,onError:e=>_({code:"PASTE_ERROR",message:e}),disabled:P.isLoading})]})]}),P.isLoading&&(0,t.jsx)(l.Zb,{children:(0,t.jsx)(l.aY,{className:"p-6 text-center",children:(0,t.jsxs)("div",{className:"flex items-center justify-center space-x-3",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),(0,t.jsx)("span",{className:"text-lg font-medium",children:"Parsing your lab results..."})]})})}),"ready"===C&&L.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Review Parsed Results"}),(0,t.jsx)(ea,{biomarkers:L,onBiomarkerEdit:(e,s)=>{q(e,s)},onConfirmAll:R,isLoading:i,error:b})]}),(P.isError||b)&&(0,t.jsxs)(o,{className:"border-red-200 bg-red-50",children:[(0,t.jsx)(m.Z,{className:"h-4 w-4 text-red-600"}),(0,t.jsx)(c,{className:"text-red-800",children:(null===(e=P.error)||void 0===e?void 0:e.message)||b})]})]})}),(0,t.jsx)(n.nU,{value:"biomarkers",children:(0,t.jsxs)(l.Zb,{children:[(0,t.jsxs)(l.Ol,{children:[(0,t.jsxs)(l.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(x.Z,{className:"h-5 w-5"}),"Biomarker Data Entry"]}),(0,t.jsx)(l.SZ,{children:"Enter your biomarker values manually or upload a CSV file. We support all major biomarkers including metabolic, cardiovascular, and inflammatory markers."})]}),(0,t.jsx)(l.aY,{children:(0,t.jsx)(T,{onSubmit:B,isLoading:i||w})})]})}),(0,t.jsx)(n.nU,{value:"questionnaire",children:(0,t.jsxs)(l.Zb,{children:[(0,t.jsxs)(l.Ol,{children:[(0,t.jsxs)(l.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(h.Z,{className:"h-5 w-5"}),"Health Assessment Questionnaire"]}),(0,t.jsx)(l.SZ,{children:"Complete our comprehensive 58-question health assessment to get personalized insights based on your lifestyle, medical history, and health patterns."})]}),(0,t.jsx)(l.aY,{children:(0,t.jsx)(E,{onSubmit:O,isLoading:i||w})})]})}),(0,t.jsx)(n.nU,{value:"combined",children:(0,t.jsxs)(l.Zb,{children:[(0,t.jsxs)(l.Ol,{children:[(0,t.jsxs)(l.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(p.Z,{className:"h-5 w-5"}),"Combined Analysis"]}),(0,t.jsx)(l.SZ,{children:"For the most comprehensive analysis, provide both biomarker data and complete the health questionnaire. This gives our AI the most complete picture of your health."})]}),(0,t.jsx)(l.aY,{children:(0,t.jsx)(eu,{onSubmit:D,isLoading:i||w})})]})})]})]})})}function eu(e){let{onSubmit:s,isLoading:a}=e,[n,o]=(0,r.useState)(null),[c,m]=(0,r.useState)(null),[u,x]=(0,r.useState)("biomarkers"),h=en(),p=ei(),g=e=>{console.debug("[CombinedAnalysisForm] Converting parsed biomarkers:",e);let s={};return e.forEach(e=>{e.name&&void 0!==e.value&&(s[e.name.toLowerCase().replace(/[^a-z0-9_]/g,"_")]={value:"string"==typeof e.value?parseFloat(e.value)||0:e.value,unit:e.unit||"",date:new Date().toISOString().split("T")[0]})}),console.debug("[CombinedAnalysisForm] Converted biomarkers:",s),s};return r.useEffect(()=>{h.length>0&&"ready"===p&&!n&&(console.debug("[CombinedAnalysisForm] Auto-populating biomarkers from parsed data"),o(g(h)))},[h,p,n]),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-center space-x-4",children:[(0,t.jsxs)("div",{className:"flex items-center ".concat("biomarkers"===u?"text-blue-600":n?"text-green-600":"text-gray-400"),children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center ".concat("biomarkers"===u?"bg-blue-100":n?"bg-green-100":"bg-gray-100"),children:n?(0,t.jsx)(d.Z,{className:"h-4 w-4"}):"1"}),(0,t.jsx)("span",{className:"ml-2 text-sm font-medium",children:"Biomarkers"})]}),(0,t.jsx)("div",{className:"w-8 h-0.5 bg-gray-200"}),(0,t.jsxs)("div",{className:"flex items-center ".concat("questionnaire"===u?"text-blue-600":c?"text-green-600":"text-gray-400"),children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center ".concat("questionnaire"===u?"bg-blue-100":c?"bg-green-100":"bg-gray-100"),children:c?(0,t.jsx)(d.Z,{className:"h-4 w-4"}):"2"}),(0,t.jsx)("span",{className:"ml-2 text-sm font-medium",children:"Questionnaire"})]}),(0,t.jsx)("div",{className:"w-8 h-0.5 bg-gray-200"}),(0,t.jsxs)("div",{className:"flex items-center ".concat("review"===u?"text-blue-600":"text-gray-400"),children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center ".concat("review"===u?"bg-blue-100":"bg-gray-100"),children:"3"}),(0,t.jsx)("span",{className:"ml-2 text-sm font-medium",children:"Review"})]})]}),"biomarkers"===u&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Step 1: Enter Biomarker Data"}),h.length>0&&"ready"===p&&(0,t.jsx)("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded-lg",children:(0,t.jsxs)("p",{className:"text-sm text-green-800",children:["✅ Found ",h.length," biomarkers from uploaded file. They have been pre-populated below."]})}),(0,t.jsx)(T,{onSubmit:e=>{console.debug("[CombinedAnalysisForm] Biomarker form submitted:",e),o(e),x("questionnaire")},isLoading:a,showSubmitButton:!0,initialData:n})]}),"questionnaire"===u&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Step 2: Complete Health Questionnaire"}),(0,t.jsx)(E,{onSubmit:e=>{console.debug("[CombinedAnalysisForm] Questionnaire form submitted:",e),m(e),x("review")},isLoading:a})]}),"review"===u&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Step 3: Review and Submit"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)(l.Zb,{children:[(0,t.jsx)(l.Ol,{children:(0,t.jsx)(l.ll,{className:"text-base",children:"Biomarker Data"})}),(0,t.jsx)(l.aY,{children:(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:[Object.keys(n||{}).length," biomarkers entered"]})})]}),(0,t.jsxs)(l.Zb,{children:[(0,t.jsx)(l.Ol,{children:(0,t.jsx)(l.ll,{className:"text-base",children:"Questionnaire Data"})}),(0,t.jsx)(l.aY,{children:(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Health questionnaire completed"})})]}),(0,t.jsxs)("div",{className:"flex justify-between pt-4",children:[(0,t.jsx)(i.z,{variant:"outline",onClick:()=>x("questionnaire"),disabled:a,children:"Back to Questionnaire"}),(0,t.jsx)(i.z,{onClick:()=>{console.debug("[CombinedAnalysisForm] Final submit - biomarkers:",n,"questionnaire:",c),n&&c&&s({biomarkers:n,questionnaire:c})},disabled:a||!(()=>{switch(u){case"biomarkers":return null!==n;case"questionnaire":return null!==c;case"review":return null!==n&&null!==c;default:return!1}})(),className:"bg-green-600 hover:bg-green-700",children:a?"Starting Analysis...":"Start Combined Analysis"})]})]})]})]})}}},function(e){e.O(0,[566,904,262,955,116,971,117,744],function(){return e(e.s=3595)}),_N_E=e.O()}]);