(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[676],{9089:function(e,s,a){Promise.resolve().then(a.bind(a,7449))},2835:function(e,s,a){"use strict";a.d(s,{cn:function(){return l}});var t=a(1994),r=a(3335);function l(){for(var e=arguments.length,s=Array(e),a=0;a<e;a++)s[a]=arguments[a];return(0,r.m6)((0,t.W)(s))}},7449:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return ep}});var t=a(7437),r=a(2265),l=a(4029),i=a(2595),n=a(1098);function o(e){let{variant:s="default",className:a="",children:r,...l}=e;return(0,t.jsx)("div",{role:"alert",className:"relative w-full rounded-lg border p-4 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7 ".concat({default:"bg-background text-foreground border",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}[s]," ").concat(a),...l,children:r})}function c(e){let{className:s="",children:a,...r}=e;return(0,t.jsx)("div",{className:"text-sm [&_p]:leading-relaxed ".concat(s),...r,children:a})}var d=a(1671),m=a(9322),u=a(7265),x=a(91),h=a(8736),p=a(7689),g=a(5277);let j=r.forwardRef((e,s)=>{let{className:a="",type:r="text",...l}=e;return(0,t.jsx)("input",{type:r,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 ".concat(a),ref:s,...l})});function f(e){let{className:s="",children:a,...r}=e;return(0,t.jsx)("label",{className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 ".concat(s),...r,children:a})}j.displayName="Input";var b=a(7709),y=a(875),v=a(2135),N=a(401),w=a(2835);let k=b.fC;b.ZA;let C=b.B4,L=r.forwardRef((e,s)=>{let{className:a,children:r,...l}=e;return(0,t.jsxs)(b.xz,{ref:s,className:(0,w.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...l,children:[r,(0,t.jsx)(b.JO,{asChild:!0,children:(0,t.jsx)(y.Z,{className:"h-4 w-4 opacity-50"})})]})});L.displayName=b.xz.displayName;let S=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(b.u_,{ref:s,className:(0,w.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,t.jsx)(v.Z,{className:"h-4 w-4"})})});S.displayName=b.u_.displayName;let q=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(b.$G,{ref:s,className:(0,w.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,t.jsx)(y.Z,{className:"h-4 w-4"})})});q.displayName=b.$G.displayName;let _=r.forwardRef((e,s)=>{let{className:a,children:r,position:l="popper",...i}=e;return(0,t.jsx)(b.h_,{children:(0,t.jsxs)(b.VY,{ref:s,className:(0,w.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:l,...i,children:[(0,t.jsx)(S,{}),(0,t.jsx)(b.l_,{className:(0,w.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,t.jsx)(q,{})]})})});_.displayName=b.VY.displayName,r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(b.__,{ref:s,className:(0,w.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...r})}).displayName=b.__.displayName;let T=r.forwardRef((e,s)=>{let{className:a,children:r,...l}=e;return(0,t.jsxs)(b.ck,{ref:s,className:(0,w.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...l,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(b.wU,{children:(0,t.jsx)(N.Z,{className:"h-4 w-4"})})}),(0,t.jsx)(b.eT,{children:r})]})});T.displayName=b.ck.displayName,r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(b.Z0,{ref:s,className:(0,w.cn)("-mx-1 my-1 h-px bg-muted",a),...r})}).displayName=b.Z0.displayName;var Z=a(9397),A=a(8930);let F={glucose:{name:"Glucose",units:["mg/dL","mmol/L"],category:"metabolic"},hba1c:{name:"HbA1c",units:["%","mmol/mol"],category:"metabolic"},insulin:{name:"Insulin",units:["μU/mL","pmol/L"],category:"metabolic"},c_peptide:{name:"C-Peptide",units:["ng/mL","nmol/L"],category:"metabolic"},total_cholesterol:{name:"Total Cholesterol",units:["mg/dL","mmol/L"],category:"cardiovascular"},ldl_cholesterol:{name:"LDL Cholesterol",units:["mg/dL","mmol/L"],category:"cardiovascular"},hdl_cholesterol:{name:"HDL Cholesterol",units:["mg/dL","mmol/L"],category:"cardiovascular"},triglycerides:{name:"Triglycerides",units:["mg/dL","mmol/L"],category:"cardiovascular"},apolipoprotein_b:{name:"Apolipoprotein B",units:["mg/dL","g/L"],category:"cardiovascular"},apolipoprotein_a1:{name:"Apolipoprotein A1",units:["mg/dL","g/L"],category:"cardiovascular"},crp:{name:"C-Reactive Protein (CRP)",units:["mg/L","mg/dL"],category:"inflammatory"},esr:{name:"Erythrocyte Sedimentation Rate (ESR)",units:["mm/hr"],category:"inflammatory"},il_6:{name:"Interleukin-6 (IL-6)",units:["pg/mL","ng/L"],category:"inflammatory"},tnf_alpha:{name:"TNF-α",units:["pg/mL","ng/L"],category:"inflammatory"},creatinine:{name:"Creatinine",units:["mg/dL","μmol/L"],category:"organ"},bun:{name:"Blood Urea Nitrogen (BUN)",units:["mg/dL","mmol/L"],category:"organ"},alt:{name:"ALT (Alanine Aminotransferase)",units:["U/L"],category:"organ"},ast:{name:"AST (Aspartate Aminotransferase)",units:["U/L"],category:"organ"},ggt:{name:"GGT (Gamma-Glutamyl Transferase)",units:["U/L"],category:"organ"},alkaline_phosphatase:{name:"Alkaline Phosphatase",units:["U/L"],category:"organ"},hemoglobin:{name:"Hemoglobin",units:["g/dL","g/L"],category:"cbc"},hematocrit:{name:"Hematocrit",units:["%","L/L"],category:"cbc"},wbc:{name:"White Blood Cell Count",units:["K/μL","\xd710⁹/L"],category:"cbc"},rbc:{name:"Red Blood Cell Count",units:["M/μL","\xd710\xb9\xb2/L"],category:"cbc"},platelets:{name:"Platelet Count",units:["K/μL","\xd710⁹/L"],category:"cbc"},tsh:{name:"TSH (Thyroid Stimulating Hormone)",units:["mIU/L","μIU/mL"],category:"hormonal"},free_t4:{name:"Free T4",units:["ng/dL","pmol/L"],category:"hormonal"},free_t3:{name:"Free T3",units:["pg/mL","pmol/L"],category:"hormonal"},cortisol:{name:"Cortisol",units:["μg/dL","nmol/L"],category:"hormonal"},testosterone:{name:"Testosterone",units:["ng/dL","nmol/L"],category:"hormonal"},vitamin_d:{name:"Vitamin D (25-OH)",units:["ng/mL","nmol/L"],category:"nutritional"},vitamin_b12:{name:"Vitamin B12",units:["pg/mL","pmol/L"],category:"nutritional"},folate:{name:"Folate",units:["ng/mL","nmol/L"],category:"nutritional"},iron:{name:"Iron",units:["μg/dL","μmol/L"],category:"nutritional"},ferritin:{name:"Ferritin",units:["ng/mL","μg/L"],category:"nutritional"}},P={metabolic:"Metabolic Health",cardiovascular:"Cardiovascular Health",inflammatory:"Inflammatory Health",organ:"Organ Function",cbc:"Complete Blood Count",hormonal:"Hormonal Health",nutritional:"Nutritional Status"};function R(e){let{onSubmit:s,onCancel:a,isLoading:m=!1,showSubmitButton:u=!0}=e,[h,g]=(0,r.useState)([]),[b,y]=(0,r.useState)({}),[v,N]=(0,r.useState)("manual"),[w,S]=(0,r.useState)(""),q=()=>{g([...h,{id:"",value:0,unit:"",date:new Date().toISOString().split("T")[0]}])},R=e=>{g(h.filter((s,a)=>a!==e))},E=(e,s,a)=>{let t=[...h];t[e]={...t[e],[s]:a},g(t),b["biomarker_".concat(e)]&&y(s=>{let a={...s};return delete a["biomarker_".concat(e)],a})},U=()=>{let e={};return h.forEach((s,a)=>{s.id||(e["biomarker_".concat(a)]="Please select a biomarker"),(!s.value||s.value<=0)&&(e["biomarker_".concat(a)]="Please enter a valid value"),s.unit||(e["biomarker_".concat(a)]="Please select a unit")}),y(e),0===Object.keys(e).length},z=e=>{let s=e.split("\n").filter(e=>e.trim());s[0].split(",").map(e=>e.trim().toLowerCase());let a=[];for(let e=1;e<s.length;e++){let t=s[e].split(",").map(e=>e.trim());if(t.length>=2){let e=t[0].toLowerCase().replace(/[^a-z0-9_]/g,"_"),s=parseFloat(t[1]),r=t[2]||"",l=t[3]||new Date().toISOString().split("T")[0];isNaN(s)||a.push({id:e,value:s,unit:r,date:l})}}g(a)},B=(()=>{let e={};return Object.entries(F).forEach(s=>{let[a,t]=s;e[t.category]||(e[t.category]=[]),e[t.category].push(a)}),e})();return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)(n.mQ,{value:v,onValueChange:N,children:[(0,t.jsxs)(n.dr,{className:"grid w-full grid-cols-2",children:[(0,t.jsxs)(n.SP,{value:"manual",className:"flex items-center gap-2",children:[(0,t.jsx)(x.Z,{className:"h-4 w-4"}),"Manual Entry"]}),(0,t.jsxs)(n.SP,{value:"upload",className:"flex items-center gap-2",children:[(0,t.jsx)(p.Z,{className:"h-4 w-4"}),"CSV Upload"]})]}),(0,t.jsxs)(n.nU,{value:"manual",className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"Enter Biomarker Values"}),(0,t.jsxs)(i.z,{onClick:q,size:"sm",className:"flex items-center gap-2",children:[(0,t.jsx)(Z.Z,{className:"h-4 w-4"}),"Add Biomarker"]})]}),0===h.length?(0,t.jsx)(l.Zb,{className:"border-dashed",children:(0,t.jsx)(l.aY,{className:"pt-6",children:(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(x.Z,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-500 mb-4",children:"No biomarkers added yet"}),(0,t.jsx)(i.z,{onClick:q,variant:"outline",children:"Add Your First Biomarker"})]})})}):(0,t.jsx)("div",{className:"space-y-4",children:h.map((e,s)=>{var a;return(0,t.jsx)(l.Zb,{className:"border-l-4 border-l-blue-500",children:(0,t.jsxs)(l.aY,{className:"pt-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(f,{htmlFor:"biomarker-".concat(s),children:"Biomarker"}),(0,t.jsxs)(k,{value:e.id,onValueChange:e=>E(s,"id",e),children:[(0,t.jsx)(L,{children:(0,t.jsx)(C,{placeholder:"Select biomarker"})}),(0,t.jsx)(_,{className:"max-h-60",children:Object.entries(B).map(e=>{let[s,a]=e;return(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"px-2 py-1 text-xs font-semibold text-gray-500 bg-gray-50",children:P[s]}),a.map(e=>{var s;return(0,t.jsx)(T,{value:e,children:null===(s=F[e])||void 0===s?void 0:s.name},e)})]},s)})})]}),b["biomarker_".concat(s)]&&(0,t.jsx)("p",{className:"text-xs text-red-500 mt-1",children:b["biomarker_".concat(s)]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(f,{htmlFor:"value-".concat(s),children:"Value"}),(0,t.jsx)(j,{id:"value-".concat(s),type:"number",step:"0.01",value:e.value||"",onChange:e=>E(s,"value",parseFloat(e.target.value)),placeholder:"Enter value"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(f,{htmlFor:"unit-".concat(s),children:"Unit"}),(0,t.jsxs)(k,{value:e.unit,onValueChange:e=>E(s,"unit",e),children:[(0,t.jsx)(L,{children:(0,t.jsx)(C,{placeholder:"Select unit"})}),(0,t.jsx)(_,{children:e.id&&(null===(a=F[e.id])||void 0===a?void 0:a.units.map(e=>(0,t.jsx)(T,{value:e,children:e},e)))})]})]}),(0,t.jsx)("div",{className:"flex items-end",children:(0,t.jsx)(i.z,{type:"button",variant:"outline",size:"sm",onClick:()=>R(s),className:"text-red-600 hover:text-red-700",children:(0,t.jsx)(A.Z,{className:"h-4 w-4"})})})]}),(0,t.jsxs)("div",{className:"mt-3",children:[(0,t.jsx)(f,{htmlFor:"date-".concat(s),children:"Date (Optional)"}),(0,t.jsx)(j,{id:"date-".concat(s),type:"date",value:e.date||"",onChange:e=>E(s,"date",e.target.value),className:"max-w-xs"})]})]})},s)})})]}),(0,t.jsx)(n.nU,{value:"upload",className:"space-y-4",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Upload CSV File"}),(0,t.jsx)(l.Zb,{className:"border-dashed",children:(0,t.jsx)(l.aY,{className:"pt-6",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(p.Z,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:"Upload a CSV file with your biomarker data. Format: biomarker_id, value, unit, date"}),(0,t.jsx)("input",{type:"file",accept:".csv",onChange:e=>{var s;let a=null===(s=e.target.files)||void 0===s?void 0:s[0];if(!a)return;let t=new FileReader;t.onload=e=>{var s;let a=null===(s=e.target)||void 0===s?void 0:s.result;S(a),z(a)},t.readAsText(a)},className:"hidden",id:"csv-upload"}),(0,t.jsx)(f,{htmlFor:"csv-upload",children:(0,t.jsx)(i.z,{variant:"outline",onClick:()=>{var e;return null===(e=document.getElementById("csv-upload"))||void 0===e?void 0:e.click()},children:"Choose CSV File"})})]})})}),w&&(0,t.jsxs)(o,{children:[(0,t.jsx)(d.Z,{className:"h-4 w-4"}),(0,t.jsxs)(c,{children:["CSV file processed. ",h.length," biomarkers loaded."]})]})]})})]}),u&&(0,t.jsxs)("div",{className:"flex justify-between pt-6",children:[(0,t.jsx)(i.z,{variant:"outline",onClick:a,disabled:m,children:"Cancel"}),(0,t.jsx)(i.z,{onClick:()=>{U()&&s(h.reduce((e,s)=>(e[s.id]={value:s.value,unit:s.unit,date:s.date},e),{}))},disabled:m||0===h.length,className:"bg-blue-600 hover:bg-blue-700",children:m?"Processing...":"Submit ".concat(h.length," Biomarkers")})]})]})}function E(e){let{value:s=[0],onValueChange:a,min:r=0,max:l=100,step:i=1,className:n=""}=e;return(0,t.jsx)("div",{className:"relative flex w-full touch-none select-none items-center ".concat(n),children:(0,t.jsx)("input",{type:"range",min:r,max:l,step:i,value:s[0],onChange:e=>{a&&a([parseInt(e.target.value)])},className:"w-full h-2 bg-secondary rounded-lg appearance-none cursor-pointer"})})}function U(e){let{className:s="",onCheckedChange:a,...r}=e;return(0,t.jsx)("input",{type:"checkbox",className:"h-4 w-4 rounded border border-primary text-primary focus:ring-2 focus:ring-ring focus:ring-offset-2 ".concat(s),onChange:e=>{a&&a(e.target.checked)},...r})}let z=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("textarea",{className:(0,w.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:s,...r})});z.displayName="Textarea";var B=a(1236),D=a(1817);function O(e){let{onSubmit:s,onCancel:a,initialData:n={},isLoading:o=!1}=e,[c,m]=(0,r.useState)([]),[u,x]=(0,r.useState)(n),[h,p]=(0,r.useState)(0),[g,b]=(0,r.useState)({}),[y,v]=(0,r.useState)(!1),[N,w]=(0,r.useState)(!0),S=Math.ceil(c.length/5);(0,r.useEffect)(()=>{q()},[]);let q=async()=>{try{m([{id:"full_name",section:"demographics",question:"Full Name",type:"text",required:!0},{id:"email_address",section:"demographics",question:"Email Address",type:"email",required:!0},{id:"phone_number",section:"demographics",question:"Phone Number",type:"phone",required:!0},{id:"country",section:"demographics",question:"Country",type:"dropdown",options:["United Kingdom","United States","Canada","Australia","Other"],required:!0},{id:"state_province",section:"demographics",question:"State/Province",type:"text",required:!1},{id:"date_of_birth",section:"demographics",question:"Date of Birth",type:"date",required:!0},{id:"biological_sex",section:"demographics",question:"Biological Sex",type:"dropdown",options:["Male","Female","Intersex"],required:!0},{id:"height",section:"demographics",question:"Height",type:"group",fields:[{label:"Feet",type:"number",min:3,max:8},{label:"Inches",type:"number",min:0,max:11}],alternativeUnit:{label:"Height (cm)",type:"number",min:100,max:250},required:!0},{id:"weight",section:"demographics",question:"Weight",type:"number",label:"Weight (lbs)",alternativeUnit:{label:"Weight (kg)",type:"number",min:30,max:300},required:!0},{id:"sleep_hours_nightly",section:"lifestyle",question:"How many hours of sleep do you typically get per night?",type:"dropdown",options:["Less than 5 hours","5-6 hours","7-8 hours","9+ hours"],required:!0},{id:"sleep_quality_rating",section:"lifestyle",question:"Rate your sleep quality (1-10)",type:"slider",min:1,max:10,labels:{1:"Wake up exhausted",5:"Somewhat rested",10:"Always refreshed"},required:!0},{id:"alcohol_drinks_weekly",section:"lifestyle",question:"How many alcoholic drinks do you consume per week?",type:"dropdown",options:["None","1-3 drinks","4-7 drinks","8-14 drinks","15+ drinks"],helpText:"1 drink = 12oz beer, 5oz wine, or 1.5oz spirits",required:!0},{id:"tobacco_use",section:"lifestyle",question:"Do you currently use tobacco products?",type:"dropdown",options:["Never used","Former user quit >1 year","Former user quit <1 year","Occasional use","Daily use"],required:!0},{id:"stress_level_rating",section:"lifestyle",question:"Rate your average stress level (1-10)",type:"slider",min:1,max:10,labels:{1:"Very low stress",5:"Moderate stress",10:"Overwhelming stress"},required:!0},{id:"vigorous_exercise_days",section:"lifestyle",question:"How many days per week do you do vigorous exercise (20+ min)?",type:"dropdown",options:["0 days","1 day","2 days","3 days","4+ days"],helpText:"Vigorous = hard breathing and sweating",required:!0},{id:"current_medications",section:"medical_history",question:"Are you currently taking any prescription medications?",type:"dropdown",options:["None","1-2 medications","3-5 medications","6+ medications","Prefer not to say"],required:!0},{id:"long_term_medications",section:"medical_history",question:"Are you currently taking any of the following long-term medications?",type:"checkbox",options:["None","Corticosteroids","Atypical antipsychotics","HIV/AIDS treatments"],required:!0,helpText:"These medications can affect cardiovascular risk assessment"},{id:"chronic_conditions",section:"medical_history",question:"Do you have any diagnosed chronic conditions?",type:"checkbox",options:["None","High blood pressure","High cholesterol","Diabetes Type 1","Diabetes Type 2","Heart disease","Thyroid disorder","Autoimmune condition","Liver disease","Kidney disease","Other"],allowOther:!0,required:!0},{id:"medical_conditions",section:"medical_history",question:"Have you ever been diagnosed with any of the following medical conditions?",type:"checkbox",options:["None","Atrial fibrillation","Rheumatoid arthritis","Systemic lupus erythematosus (SLE)"],required:!0,helpText:"These conditions can affect cardiovascular risk assessment"},{id:"current_symptoms",section:"symptoms",question:"Do you have any current symptoms affecting your daily life?",type:"checkbox",options:["None","Fatigue","Brain fog","Joint pain","Digestive issues","Sleep problems","Mood changes","Other"],allowOther:!0,required:!0},{id:"regular_migraines",section:"symptoms",question:"Do you suffer from regular migraines?",type:"dropdown",options:["Yes","No","Not sure"],required:!0,helpText:"Migraines can be associated with cardiovascular risk factors"}]),w(!1)}catch(e){console.error("Failed to load questions:",e),w(!1)}},Z=()=>{let e=5*h;return c.slice(e,e+5)},A=(e,s)=>{x(a=>({...a,[e]:s})),g[e]&&b(s=>{let a={...s};return delete a[e],a})},F=()=>{let e=Z(),s={};return e.forEach(e=>{e.required&&(!u[e.id]||""===u[e.id])&&(s[e.id]="This field is required")}),b(s),0===Object.keys(s).length},P=async()=>{if(F()){v(!0);try{await s(u)}catch(e){console.error("Failed to submit questionnaire:",e)}finally{v(!1)}}},R=e=>{var s,a,r;let l=u[e.id],i=g[e.id];switch(e.type){case"text":case"email":case"phone":case"date":return(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(f,{htmlFor:e.id,className:"text-sm font-medium",children:[e.question,e.required&&(0,t.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,t.jsx)(j,{id:e.id,type:e.type,value:l||"",onChange:s=>A(e.id,s.target.value),className:i?"border-red-500":""}),e.helpText&&(0,t.jsx)("p",{className:"text-xs text-gray-500",children:e.helpText}),i&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:i})]},e.id);case"number":return(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(f,{htmlFor:e.id,className:"text-sm font-medium",children:[e.question,e.required&&(0,t.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,t.jsx)(j,{id:e.id,type:"number",min:e.min,max:e.max,value:l||"",onChange:s=>A(e.id,parseFloat(s.target.value)),className:i?"border-red-500":""}),e.helpText&&(0,t.jsx)("p",{className:"text-xs text-gray-500",children:e.helpText}),i&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:i})]},e.id);case"dropdown":return(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(f,{htmlFor:e.id,className:"text-sm font-medium",children:[e.question,e.required&&(0,t.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,t.jsxs)(k,{value:l||"",onValueChange:s=>A(e.id,s),children:[(0,t.jsx)(L,{className:i?"border-red-500":"",children:(0,t.jsx)(C,{placeholder:"Select an option"})}),(0,t.jsx)(_,{children:null===(s=e.options)||void 0===s?void 0:s.map(e=>(0,t.jsx)(T,{value:e,children:e},e))})]}),e.helpText&&(0,t.jsx)("p",{className:"text-xs text-gray-500",children:e.helpText}),i&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:i})]},e.id);case"slider":return(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(f,{htmlFor:e.id,className:"text-sm font-medium",children:[e.question,e.required&&(0,t.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,t.jsxs)("div",{className:"px-3",children:[(0,t.jsx)(E,{min:e.min||1,max:e.max||10,step:1,value:l||e.min||1,onValueChange:s=>A(e.id,s),className:"w-full"}),(0,t.jsx)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:e.labels&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{children:e.labels[String(e.min||1)]}),(0,t.jsx)("span",{children:e.labels[String(e.max||10)]})]})}),(0,t.jsx)("div",{className:"text-center mt-2",children:(0,t.jsx)("span",{className:"text-lg font-semibold",children:l||e.min||1})})]}),e.helpText&&(0,t.jsx)("p",{className:"text-xs text-gray-500",children:e.helpText}),i&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:i})]},e.id);case"checkbox":return(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(f,{className:"text-sm font-medium",children:[e.question,e.required&&(0,t.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,t.jsx)("div",{className:"space-y-2",children:null===(a=e.options)||void 0===a?void 0:a.map(s=>(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(U,{id:"".concat(e.id,"-").concat(s),checked:Array.isArray(l)&&l.includes(s),onCheckedChange:a=>{let t=Array.isArray(l)?l:[];a?A(e.id,[...t,s]):A(e.id,t.filter(e=>e!==s))}}),(0,t.jsx)(f,{htmlFor:"".concat(e.id,"-").concat(s),className:"text-sm",children:s})]},s))}),e.helpText&&(0,t.jsx)("p",{className:"text-xs text-gray-500",children:e.helpText}),i&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:i})]},e.id);case"group":return(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(f,{className:"text-sm font-medium",children:[e.question,e.required&&(0,t.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:null===(r=e.fields)||void 0===r?void 0:r.map(s=>(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)(f,{htmlFor:"".concat(e.id,"-").concat(s.label),className:"text-xs",children:s.label}),(0,t.jsx)(j,{id:"".concat(e.id,"-").concat(s.label),type:s.type,min:s.min,max:s.max,value:(null==l?void 0:l[s.label])||"",onChange:a=>{let t={...l,[s.label]:"number"===s.type?parseFloat(a.target.value):a.target.value};A(e.id,t)}})]},s.label))}),e.helpText&&(0,t.jsx)("p",{className:"text-xs text-gray-500",children:e.helpText}),i&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:i})]},e.id);default:return(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(f,{htmlFor:e.id,className:"text-sm font-medium",children:[e.question,e.required&&(0,t.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,t.jsx)(z,{id:e.id,value:l||"",onChange:s=>A(e.id,s.target.value),className:i?"border-red-500":""}),e.helpText&&(0,t.jsx)("p",{className:"text-xs text-gray-500",children:e.helpText}),i&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:i})]},e.id)}};return N?(0,t.jsxs)("div",{className:"flex items-center justify-center p-8",children:[(0,t.jsx)(D.Z,{className:"h-8 w-8 animate-spin"}),(0,t.jsx)("span",{className:"ml-2",children:"Loading questionnaire..."})]}):(Z(),(0,t.jsx)("div",{className:"max-w-4xl mx-auto p-6",children:(0,t.jsxs)(l.Zb,{children:[(0,t.jsxs)(l.Ol,{children:[(0,t.jsxs)(l.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(d.Z,{className:"h-5 w-5 text-green-500"}),"Health Assessment Questionnaire"]}),(0,t.jsxs)(l.SZ,{children:["Please complete all required fields to get personalized health insights. Step ",h+1," of ",S]}),(0,t.jsx)(B.E,{value:(h+1)/S*100,className:"w-full"})]}),(0,t.jsxs)(l.aY,{className:"space-y-6",children:[Object.entries(c.reduce((e,s)=>(e[s.section]||(e[s.section]=[]),e[s.section].push(s),e),{})).map(e=>{let[s,a]=e;return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 capitalize",children:s.replace(/_/g," ")}),(0,t.jsx)("div",{className:"space-y-4 pl-4",children:a.map(R)})]},s)}),(0,t.jsxs)("div",{className:"flex justify-between pt-6",children:[(0,t.jsx)(i.z,{variant:"outline",onClick:0===h?a:()=>{p(e=>Math.max(e-1,0))},disabled:y,children:0===h?"Cancel":"Previous"}),(0,t.jsx)("div",{className:"flex gap-2",children:h<S-1?(0,t.jsx)(i.z,{onClick:()=>{F()&&p(e=>Math.min(e+1,S-1))},disabled:y,children:"Next"}):(0,t.jsx)(i.z,{onClick:P,disabled:y,className:"bg-green-600 hover:bg-green-700",children:y?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(D.Z,{className:"h-4 w-4 animate-spin mr-2"}),"Submitting..."]}):"Complete Assessment"})})]})]})]})}))}var H=a(5598);function I(e){let{onFileSelect:s,onError:a,maxSize:i=10485760,acceptedTypes:n=[".pdf",".txt",".json",".csv"],disabled:o=!1}=e,[c,d]=(0,r.useState)(!1),[u,x]=(0,r.useState)(null),g=(0,r.useCallback)(e=>{let a=e[0];a&&(x(null),s(a))},[s]),j=(0,r.useCallback)(e=>{var s,t;let r=e[0];if((null===(s=r.errors[0])||void 0===s?void 0:s.code)==="file-too-large"){let e="File too large. Maximum size is ".concat(Math.round(i/1024/1024),"MB");x(e),null==a||a(e)}else if((null===(t=r.errors[0])||void 0===t?void 0:t.code)==="file-invalid-type"){let e="Invalid file type. Accepted types: ".concat(n.join(", "));x(e),null==a||a(e)}},[i,n,a]),{getRootProps:f,getInputProps:b,isDragReject:y}=(0,H.uI)({onDrop:g,onDropRejected:j,accept:n.reduce((e,s)=>(e[s]=[],e),{}),maxSize:i,multiple:!1,disabled:o});return(0,t.jsx)(l.Zb,{className:"w-full",children:(0,t.jsxs)(l.aY,{className:"p-6",children:[(0,t.jsxs)("div",{...f(),className:"\n            border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors\n            ".concat(c?"border-primary bg-primary/5":"border-border hover:border-primary/50","\n            ").concat(y?"border-destructive bg-destructive/5":"","\n            ").concat(o?"opacity-50 cursor-not-allowed":"","\n          "),onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),children:[(0,t.jsx)("input",{...b(),id:"file-upload",name:"file",autoComplete:"off"}),(0,t.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,t.jsx)("div",{className:"p-3 bg-primary/10 rounded-full",children:(0,t.jsx)(p.Z,{className:"h-8 w-8 text-primary"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-foreground",children:"Drop your lab report here"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"or click to browse files"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-xs text-muted-foreground",children:[(0,t.jsx)(h.Z,{className:"h-4 w-4"}),(0,t.jsxs)("span",{children:["PDF, TXT, JSON, CSV up to ",Math.round(i/1024/1024),"MB"]})]})]})]}),u&&(0,t.jsxs)("div",{className:"mt-4 flex items-center space-x-2 text-destructive text-sm",children:[(0,t.jsx)(m.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:u})]})]})})}var V=a(8867);function M(e){let{onTextSubmit:s,onError:a,disabled:n=!1,placeholder:o="Paste your lab results here...\n\nExample:\nTotal Cholesterol: 180 mg/dL\nHDL Cholesterol: 45 mg/dL\nLDL Cholesterol: 110 mg/dL\nTriglycerides: 125 mg/dL"}=e,[c,d]=(0,r.useState)(""),[u,x]=(0,r.useState)(null),h=async()=>{try{let e=await navigator.clipboard.readText();d(e),x(null)}catch(s){let e="Unable to access clipboard. Please paste manually";x(e),null==a||a(e)}};return(0,t.jsxs)(l.Zb,{className:"w-full",children:[(0,t.jsx)(l.Ol,{children:(0,t.jsxs)(l.ll,{className:"flex items-center space-x-2",children:[(0,t.jsx)(V.Z,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:"Paste Lab Results"})]})}),(0,t.jsxs)(l.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(z,{id:"lab-results-text",name:"labResults",value:c,onChange:e=>{d(e.target.value),x(null)},placeholder:o,disabled:n,className:"min-h-[200px] resize-none",autoComplete:"off"}),(0,t.jsxs)("div",{className:"flex justify-between items-center text-xs text-muted-foreground",children:[(0,t.jsxs)("span",{children:[c.length," characters"]}),(0,t.jsx)("span",{children:"Minimum 10 characters required"})]})]}),u&&(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-destructive text-sm",children:[(0,t.jsx)(m.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:u})]}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)(i.z,{onClick:()=>{let e=c.trim();if(!e){let e="Please paste some lab results text before submitting";x(e),null==a||a(e);return}if(e.length<10){let e="Text appears too short. Please paste more detailed lab results";x(e),null==a||a(e);return}x(null),s(e)},disabled:n||!c.trim(),className:"flex-1",children:"Parse Lab Results"}),(0,t.jsx)(i.z,{onClick:h,variant:"outline",disabled:n,children:"Paste from Clipboard"}),(0,t.jsx)(i.z,{onClick:()=>{d(""),x(null)},variant:"outline",disabled:n||!c,children:"Clear"})]})]})]})}var Y=a(1875);let G=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{className:"relative w-full overflow-auto",children:(0,t.jsx)("table",{ref:s,className:(0,w.cn)("w-full caption-bottom text-sm",a),...r})})});G.displayName="Table";let Q=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("thead",{ref:s,className:(0,w.cn)("[&_tr]:border-b",a),...r})});Q.displayName="TableHeader";let W=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("tbody",{ref:s,className:(0,w.cn)("[&_tr:last-child]:border-0",a),...r})});W.displayName="TableBody",r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("tfoot",{ref:s,className:(0,w.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...r})}).displayName="TableFooter";let J=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("tr",{ref:s,className:(0,w.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...r})});J.displayName="TableRow";let K=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("th",{ref:s,className:(0,w.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...r})});K.displayName="TableHead";let X=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("td",{ref:s,className:(0,w.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...r})});X.displayName="TableCell",r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("caption",{ref:s,className:(0,w.cn)("mt-4 text-sm text-muted-foreground",a),...r})}).displayName="TableCaption";var $=a(5868),ee=a(2489),es=a(3229);let ea=["mg/dL","mmol/L","ng/mL","pg/mL","IU/mL","U/L","g/dL","%","cells/μL","mg/L","μg/dL","mEq/L","ng/dL","pmol/L"],et=["Total Cholesterol","HDL Cholesterol","LDL Cholesterol","Triglycerides","Glucose","HbA1c","Insulin","C-Reactive Protein","ESR","Ferritin","Vitamin D","B12","Folate","TSH","T4","T3","Creatinine","BUN","ALT","AST","GGT","ALP","Bilirubin","Albumin","Hemoglobin","Hematocrit","WBC","RBC","Platelets","Sodium","Potassium","Chloride","CO2","Calcium","Phosphorus","Magnesium"];function er(e){let{biomarker:s,isOpen:a,onSave:n,onCancel:o}=e,[c,d]=(0,r.useState)({name:"",value:"",unit:"",status:"edited"}),[u,x]=(0,r.useState)({});(0,r.useEffect)(()=>{s&&(d({name:s.name,value:s.value.toString(),unit:s.unit,status:s.status||"edited"}),x({}))},[s]);let h=()=>{let e={};if(c.name.trim()||(e.name="Biomarker name is required"),c.value.trim()){let s=parseFloat(c.value);isNaN(s)?e.value="Value must be a valid number":s<0&&(e.value="Value must be positive")}else e.value="Value is required";return c.unit.trim()||(e.unit="Unit is required"),x(e),0===Object.keys(e).length};return a&&s?(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,t.jsxs)(l.Zb,{className:"w-full max-w-md max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)(l.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-4",children:[(0,t.jsx)(l.ll,{children:"Edit Biomarker"}),(0,t.jsx)(i.z,{variant:"ghost",size:"sm",onClick:o,children:(0,t.jsx)(ee.Z,{className:"h-4 w-4"})})]}),(0,t.jsxs)(l.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(f,{htmlFor:"name",children:"Biomarker Name"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(k,{onValueChange:e=>{d(s=>({...s,name:e}))},value:c.name,children:[(0,t.jsx)(L,{children:(0,t.jsx)(C,{placeholder:"Select or type biomarker name"})}),(0,t.jsx)(_,{children:et.map(e=>(0,t.jsx)(T,{value:e,children:e},e))})]}),(0,t.jsx)(j,{id:"name",value:c.name,onChange:e=>d(s=>({...s,name:e.target.value})),placeholder:"Enter biomarker name",className:u.name?"border-red-500":""})]}),u.name&&(0,t.jsxs)("div",{className:"flex items-center space-x-1 text-destructive text-sm",children:[(0,t.jsx)(m.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:u.name})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(f,{htmlFor:"value",children:"Value"}),(0,t.jsx)(j,{id:"value",type:"number",step:"any",value:c.value,onChange:e=>d(s=>({...s,value:e.target.value})),placeholder:"Enter value",className:u.value?"border-red-500":""}),u.value&&(0,t.jsxs)("div",{className:"flex items-center space-x-1 text-destructive text-sm",children:[(0,t.jsx)(m.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:u.value})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(f,{htmlFor:"unit",children:"Unit"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(k,{onValueChange:e=>d(s=>({...s,unit:e})),value:c.unit,children:[(0,t.jsx)(L,{children:(0,t.jsx)(C,{placeholder:"Select unit"})}),(0,t.jsx)(_,{children:ea.map(e=>(0,t.jsx)(T,{value:e,children:e},e))})]}),(0,t.jsx)(j,{id:"unit",value:c.unit,onChange:e=>d(s=>({...s,unit:e.target.value})),placeholder:"Enter unit",className:u.unit?"border-red-500":""})]}),u.unit&&(0,t.jsxs)("div",{className:"flex items-center space-x-1 text-destructive text-sm",children:[(0,t.jsx)(m.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:u.unit})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(f,{children:"Status"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(Y.C,{variant:"default",children:"Edited"}),(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"This biomarker has been modified from the original"})]})]}),(0,t.jsxs)("div",{className:"flex space-x-2 pt-4",children:[(0,t.jsxs)(i.z,{onClick:()=>{if(!h())return;let e=parseFloat(c.value);n({name:c.name.trim(),value:isNaN(e)?c.value:e,unit:c.unit.trim(),status:"edited"})},className:"flex-1",children:[(0,t.jsx)(es.Z,{className:"h-4 w-4 mr-2"}),"Save Changes"]}),(0,t.jsx)(i.z,{onClick:o,variant:"outline",className:"flex-1",children:"Cancel"})]})]})]})}):null}function el(e){let{biomarkers:s,onBiomarkerEdit:a,onConfirmAll:n,isLoading:o=!1,error:c=null}=e,[d,u]=(0,r.useState)(null),x=e=>{switch(e){case"Low":return(0,t.jsx)(Y.C,{variant:"outline",className:"rounded-md px-2 py-1 text-sm font-medium text-yellow-600 border-yellow-600 bg-yellow-50",children:"Low"});case"High":return(0,t.jsx)(Y.C,{variant:"outline",className:"rounded-md px-2 py-1 text-sm font-medium text-red-600 border-red-600 bg-red-50",children:"High"});case"Normal":return(0,t.jsx)(Y.C,{variant:"outline",className:"rounded-md px-2 py-1 text-sm font-medium text-green-600 border-green-600 bg-green-50",children:"Normal"});default:return(0,t.jsx)(Y.C,{variant:"outline",className:"rounded-md px-2 py-1 text-sm font-medium text-gray-600 border-gray-600 bg-gray-50",children:"Unknown"})}},h=e=>{u(e)},p=s.length>0,g=0===s.length;return c?(0,t.jsx)(l.Zb,{className:"w-full",children:(0,t.jsx)(l.aY,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-destructive",children:[(0,t.jsx)(m.Z,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:c})]})})}):0===s.length?(0,t.jsx)(l.Zb,{className:"w-full",children:(0,t.jsx)(l.aY,{className:"p-6 text-center text-muted-foreground",children:"No biomarkers found. Please upload or paste lab results to get started."})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(l.Zb,{className:"w-full",children:[(0,t.jsx)(l.Ol,{children:(0,t.jsxs)(l.ll,{className:"flex items-center justify-between",children:[(0,t.jsxs)("span",{children:["Parsed Biomarkers (",s.length,")"]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[g&&(0,t.jsx)(Y.C,{variant:"outline",className:"text-[hsl(var(--status-fair))] border-[hsl(var(--status-fair))]",children:"Review Required"}),p&&(0,t.jsx)(Y.C,{variant:"outline",className:"text-[hsl(var(--status-excellent))] border-[hsl(var(--status-excellent))]",children:"All Confirmed"})]})]})}),(0,t.jsxs)(l.aY,{children:[(0,t.jsx)("div",{className:"rounded-md border",children:(0,t.jsxs)(G,{children:[(0,t.jsx)(Q,{children:(0,t.jsxs)(J,{children:[(0,t.jsx)(K,{children:"Biomarker"}),(0,t.jsx)(K,{className:"text-right",children:"Value"}),(0,t.jsx)(K,{children:"Unit"}),(0,t.jsx)(K,{children:"Reference Range"}),(0,t.jsx)(K,{children:"Health Status"}),(0,t.jsx)(K,{className:"w-[100px]",children:"Edit"})]})}),(0,t.jsx)(W,{children:s.map((e,s)=>(0,t.jsxs)(J,{children:[(0,t.jsx)(X,{className:"font-medium",children:e.name}),(0,t.jsx)(X,{className:"text-right",children:"number"==typeof e.value?e.value.toFixed(2):e.value}),(0,t.jsx)(X,{children:e.unit}),(0,t.jsx)(X,{children:e.reference||"—"}),(0,t.jsx)(X,{children:x(e.healthStatus||"Unknown")}),(0,t.jsx)(X,{children:(0,t.jsx)(i.z,{variant:"outline",size:"sm",onClick:()=>h(s),disabled:o,children:(0,t.jsx)($.Z,{className:"h-4 w-4"})})})]},s))})]})}),(0,t.jsx)("div",{className:"mt-4 flex justify-end",children:(0,t.jsx)(i.z,{onClick:n,disabled:o||0===s.length,className:"min-w-[120px]",children:o?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(N.Z,{className:"h-4 w-4 mr-2"}),"Confirm All"]})})})]})]}),(0,t.jsx)(er,{biomarker:null!==d?s[d]:null,isOpen:null!==d,onSave:e=>{null!==d&&(a(d,e),u(null))},onCancel:()=>{u(null)}})]})}var ei=a(2430),en=a(9625),eo=a(6885);let ec=(0,en.Ue)()((0,eo.tJ)((e,s)=>({status:"idle",parsedData:[],error:null,analysisId:null,sourceMetadata:null,setStatus:s=>e({status:s}),setParsedData:s=>e({parsedData:s}),updateBiomarker:(a,t)=>{let{parsedData:r}=s(),l=[...r];l[a]=t,e({parsedData:l})},setError:s=>e({error:s}),setAnalysisId:s=>e({analysisId:s}),setSourceMetadata:s=>e({sourceMetadata:s}),startUpload:()=>e({status:"uploading",error:null}),startParsing:()=>e({status:"parsing",error:null}),setParsedResults:(s,a,t)=>{e({parsedData:s,analysisId:a,sourceMetadata:t,status:"ready",error:null})},confirmAll:()=>{e({status:"confirmed"})},reset:()=>e({status:"idle",parsedData:[],error:null,analysisId:null,sourceMetadata:null}),hasUnconfirmedBiomarkers:()=>{let{status:e}=s();return"confirmed"!==e},allBiomarkersConfirmed:()=>{let{status:e}=s();return"confirmed"===e}}),{name:"upload-store",partialize:e=>({parsedData:e.parsedData,analysisId:e.analysisId,sourceMetadata:e.sourceMetadata,status:e.status})})),ed=()=>ec(e=>e.status),em=()=>ec(e=>e.parsedData);(0,en.Ue)()((e,s)=>({...ec.getInitialState(),reset:()=>{localStorage.removeItem("upload-store"),ec.getState().reset()},setParsedResults:(e,a,t)=>{ec.getState().setParsedResults(e,a,t);let r=s();localStorage.setItem("upload-store",JSON.stringify({parsedData:r.parsedData,analysisId:r.analysisId,sourceMetadata:r.sourceMetadata,status:r.status}))}}));var eu=a(1770);let ex=a(5566).env.NEXT_PUBLIC_API_URL||"http://localhost:8000";var eh=a(9376);function ep(){var e;let[s,a]=(0,r.useState)("upload"),[i,j]=(0,r.useState)(!1),[f,b]=(0,r.useState)(null),[y,v]=(0,r.useState)(!1),{startAnalysis:N,isLoading:w}=(0,ei._)(),k=(0,eh.useRouter)(),C=ed(),L=em(),{setParsedResults:S,updateBiomarker:q,confirmAll:_,setError:T}=ec(),Z=function(){let e=(0,eu.D)({mutationFn:async e=>{let{file:s,text:a}=e;if(!s&&!a)throw Error("Either file or text must be provided");let t=new FormData;s&&t.append("file",s),a&&t.append("text_content",a);let r=await fetch("".concat(ex,"/api/upload/parse"),{method:"POST",body:t});if(!r.ok)throw Error((await r.json().catch(()=>({}))).detail||"HTTP ".concat(r.status,": ").concat(r.statusText));let l=await r.json();if(!l.success)throw Error(l.message||"Parsing failed");return l},onError:e=>{console.error("Parse upload error:",e)}});return{data:e.data,error:e.error,isLoading:e.isPending,isSuccess:e.isSuccess,isError:e.isError,mutate:e.mutate,reset:e.reset}}(),A=async e=>{T(null),Z.mutate({file:e})},F=async e=>{T(null),Z.mutate({text:e})},P=async()=>{try{console.debug("Accept clicked, persisting parsed data:",L.length),_(),v(!0),setTimeout(()=>{k.push("/results")},2e3)}catch(e){console.error("Confirmation failed:",e),T({code:"CONFIRMATION_FAILED",message:"Failed to confirm biomarkers"})}};(0,r.useEffect)(()=>{if(Z.isSuccess&&Z.data){let{parsed_data:e}=Z.data;S(e.biomarkers,Z.data.analysis_id,e.metadata)}else Z.isError&&Z.error&&T({code:"PARSE_ERROR",message:Z.error.message||"Failed to parse upload"})},[Z.isSuccess,Z.isError,Z.data,Z.error,S,T]);let E=async e=>{j(!0),b(null);try{await N({biomarkers:e,user:{age:35,sex:"male",height:180,weight:75},questionnaire:null}),v(!0),setTimeout(()=>{k.push("/results")},2e3)}catch(e){console.error("Analysis failed:",e),b("Failed to start analysis. Please try again.")}finally{j(!1)}},U=async e=>{j(!0),b(null);try{await N({biomarkers:{},user:{age:35,sex:"male",height:180,weight:75},questionnaire:e}),v(!0),setTimeout(()=>{k.push("/results")},2e3)}catch(e){console.error("Analysis failed:",e),b("Failed to start analysis. Please try again.")}finally{j(!1)}},z=async e=>{j(!0),b(null);try{await N({biomarkers:e.biomarkers,user:{age:35,sex:"male",height:180,weight:75},questionnaire:e.questionnaire}),v(!0),setTimeout(()=>{k.push("/results")},2e3)}catch(e){console.error("Analysis failed:",e),b("Failed to start analysis. Please try again.")}finally{j(!1)}};return y?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,t.jsx)(l.Zb,{className:"w-full max-w-md",children:(0,t.jsx)(l.aY,{className:"pt-6",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(d.Z,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Analysis Started!"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:"Your health analysis is being processed. You'll be redirected to your results shortly."}),(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-500 mx-auto"})]})})})}):(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,t.jsxs)("div",{className:"container mx-auto px-4 max-w-6xl",children:[(0,t.jsxs)("div",{className:"text-center mb-8",children:[(0,t.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Health Analysis Upload"}),(0,t.jsx)("p",{className:"text-lg text-gray-600 max-w-2xl mx-auto",children:"Upload your biomarker data or complete our health questionnaire to get personalized AI-powered health insights."})]}),f&&(0,t.jsxs)(o,{className:"mb-6 border-red-200 bg-red-50",children:[(0,t.jsx)(m.Z,{className:"h-4 w-4 text-red-600"}),(0,t.jsx)(c,{className:"text-red-800",children:f})]}),(0,t.jsxs)(n.mQ,{value:s,onValueChange:a,className:"w-full",children:[(0,t.jsxs)(n.dr,{className:"grid w-full grid-cols-4 mb-8",children:[(0,t.jsxs)(n.SP,{value:"upload",className:"flex items-center gap-2",children:[(0,t.jsx)(u.Z,{className:"h-4 w-4"}),"Upload & Parse"]}),(0,t.jsxs)(n.SP,{value:"biomarkers",className:"flex items-center gap-2",children:[(0,t.jsx)(x.Z,{className:"h-4 w-4"}),"Manual Entry"]}),(0,t.jsxs)(n.SP,{value:"questionnaire",className:"flex items-center gap-2",children:[(0,t.jsx)(h.Z,{className:"h-4 w-4"}),"Questionnaire"]}),(0,t.jsxs)(n.SP,{value:"combined",className:"flex items-center gap-2",children:[(0,t.jsx)(p.Z,{className:"h-4 w-4"}),"Combined"]})]}),(0,t.jsx)(n.nU,{value:"upload",children:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[(0,t.jsx)(u.Z,{className:"h-5 w-5"}),"Upload Lab Report"]}),(0,t.jsx)(I,{onFileSelect:A,onError:e=>T({code:"UPLOAD_ERROR",message:e}),disabled:Z.isLoading})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[(0,t.jsx)(g.Z,{className:"h-5 w-5"}),"Paste Lab Results"]}),(0,t.jsx)(M,{onTextSubmit:F,onError:e=>T({code:"PASTE_ERROR",message:e}),disabled:Z.isLoading})]})]}),Z.isLoading&&(0,t.jsx)(l.Zb,{children:(0,t.jsx)(l.aY,{className:"p-6 text-center",children:(0,t.jsxs)("div",{className:"flex items-center justify-center space-x-3",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),(0,t.jsx)("span",{className:"text-lg font-medium",children:"Parsing your lab results..."})]})})}),"ready"===C&&L.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Review Parsed Results"}),(0,t.jsx)(el,{biomarkers:L,onBiomarkerEdit:(e,s)=>{q(e,s)},onConfirmAll:P,isLoading:i,error:f})]}),(Z.isError||f)&&(0,t.jsxs)(o,{className:"border-red-200 bg-red-50",children:[(0,t.jsx)(m.Z,{className:"h-4 w-4 text-red-600"}),(0,t.jsx)(c,{className:"text-red-800",children:(null===(e=Z.error)||void 0===e?void 0:e.message)||f})]})]})}),(0,t.jsx)(n.nU,{value:"biomarkers",children:(0,t.jsxs)(l.Zb,{children:[(0,t.jsxs)(l.Ol,{children:[(0,t.jsxs)(l.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(x.Z,{className:"h-5 w-5"}),"Biomarker Data Entry"]}),(0,t.jsx)(l.SZ,{children:"Enter your biomarker values manually or upload a CSV file. We support all major biomarkers including metabolic, cardiovascular, and inflammatory markers."})]}),(0,t.jsx)(l.aY,{children:(0,t.jsx)(R,{onSubmit:E,isLoading:i||w})})]})}),(0,t.jsx)(n.nU,{value:"questionnaire",children:(0,t.jsxs)(l.Zb,{children:[(0,t.jsxs)(l.Ol,{children:[(0,t.jsxs)(l.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(h.Z,{className:"h-5 w-5"}),"Health Assessment Questionnaire"]}),(0,t.jsx)(l.SZ,{children:"Complete our comprehensive 58-question health assessment to get personalized insights based on your lifestyle, medical history, and health patterns."})]}),(0,t.jsx)(l.aY,{children:(0,t.jsx)(O,{onSubmit:U,isLoading:i||w})})]})}),(0,t.jsx)(n.nU,{value:"combined",children:(0,t.jsxs)(l.Zb,{children:[(0,t.jsxs)(l.Ol,{children:[(0,t.jsxs)(l.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(p.Z,{className:"h-5 w-5"}),"Combined Analysis"]}),(0,t.jsx)(l.SZ,{children:"For the most comprehensive analysis, provide both biomarker data and complete the health questionnaire. This gives our AI the most complete picture of your health."})]}),(0,t.jsx)(l.aY,{children:(0,t.jsx)(eg,{onSubmit:z,isLoading:i||w})})]})})]})]})})}function eg(e){let{onSubmit:s,isLoading:a}=e,[n,o]=(0,r.useState)(null),[c,m]=(0,r.useState)(null),[u,x]=(0,r.useState)("biomarkers"),h=em(),p=ed();return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-center space-x-4",children:[(0,t.jsxs)("div",{className:"flex items-center ".concat("biomarkers"===u?"text-blue-600":n||h.length>0&&"confirmed"===p?"text-green-600":"text-gray-400"),children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center ".concat("biomarkers"===u?"bg-blue-100":n||h.length>0&&"confirmed"===p?"bg-green-100":"bg-gray-100"),children:n||h.length>0&&"confirmed"===p?(0,t.jsx)(d.Z,{className:"h-4 w-4"}):"1"}),(0,t.jsx)("span",{className:"ml-2 text-sm font-medium",children:"Biomarkers"})]}),(0,t.jsx)("div",{className:"w-8 h-0.5 bg-gray-200"}),(0,t.jsxs)("div",{className:"flex items-center ".concat("questionnaire"===u?"text-blue-600":c?"text-green-600":"text-gray-400"),children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center ".concat("questionnaire"===u?"bg-blue-100":c?"bg-green-100":"bg-gray-100"),children:c?(0,t.jsx)(d.Z,{className:"h-4 w-4"}):"2"}),(0,t.jsx)("span",{className:"ml-2 text-sm font-medium",children:"Questionnaire"})]}),(0,t.jsx)("div",{className:"w-8 h-0.5 bg-gray-200"}),(0,t.jsxs)("div",{className:"flex items-center ".concat("review"===u?"text-blue-600":"text-gray-400"),children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center ".concat("review"===u?"bg-blue-100":"bg-gray-100"),children:"3"}),(0,t.jsx)("span",{className:"ml-2 text-sm font-medium",children:"Review"})]})]}),"biomarkers"===u&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Step 1: Enter Biomarker Data"}),h.length>0&&"confirmed"===p?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-green-800",children:[(0,t.jsx)(d.Z,{className:"h-5 w-5"}),(0,t.jsx)("span",{className:"font-medium",children:"Parsed biomarkers confirmed!"})]}),(0,t.jsxs)("p",{className:"text-sm text-green-700 mt-1",children:[h.length," biomarkers are ready for analysis. You can proceed to the questionnaire or add additional biomarkers manually."]})]}),(0,t.jsxs)("div",{className:"flex space-x-4",children:[(0,t.jsx)(i.z,{onClick:()=>x("questionnaire"),className:"bg-green-600 hover:bg-green-700",children:"Use Parsed Data & Continue"}),(0,t.jsx)(i.z,{variant:"outline",onClick:()=>o({}),children:"Add Additional Biomarkers"})]})]}):(0,t.jsx)(R,{onSubmit:e=>{o(e),x("questionnaire")},isLoading:a,showSubmitButton:!0})]}),"questionnaire"===u&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Step 2: Complete Health Questionnaire"}),(0,t.jsx)(O,{onSubmit:e=>{m(e),x("review")},isLoading:a})]}),"review"===u&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Step 3: Review and Submit"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)(l.Zb,{children:[(0,t.jsx)(l.Ol,{children:(0,t.jsx)(l.ll,{className:"text-base",children:"Biomarker Data"})}),(0,t.jsxs)(l.aY,{children:[(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:[n?Object.keys(n).length:h.length," biomarkers ready for analysis"]}),h.length>0&&"confirmed"===p&&!n&&(0,t.jsx)("p",{className:"text-xs text-green-600 mt-1",children:"Using confirmed parsed biomarkers"})]})]}),(0,t.jsxs)(l.Zb,{children:[(0,t.jsx)(l.Ol,{children:(0,t.jsx)(l.ll,{className:"text-base",children:"Questionnaire Data"})}),(0,t.jsx)(l.aY,{children:(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Health questionnaire completed"})})]}),(0,t.jsxs)("div",{className:"flex justify-between pt-4",children:[(0,t.jsx)(i.z,{variant:"outline",onClick:()=>x("questionnaire"),disabled:a,children:"Back to Questionnaire"}),(0,t.jsx)(i.z,{onClick:()=>{let e=n||(h.length>0&&"confirmed"===p?h:null);e&&c&&s({biomarkers:e,questionnaire:c})},disabled:a||!(()=>{switch(u){case"biomarkers":return null!==n||h.length>0&&"confirmed"===p;case"questionnaire":return null!==c;case"review":return(null!==n||h.length>0&&"confirmed"===p)&&null!==c;default:return!1}})(),className:"bg-green-600 hover:bg-green-700",children:a?"Starting Analysis...":"Start Combined Analysis"})]})]})]})]})}}},function(e){e.O(0,[904,543,262,260,116,971,117,744],function(){return e(e.s=9089)}),_N_E=e.O()}]);