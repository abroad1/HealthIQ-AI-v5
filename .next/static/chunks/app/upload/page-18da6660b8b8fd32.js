(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[676],{9089:function(e,s,a){Promise.resolve().then(a.bind(a,1606))},2835:function(e,s,a){"use strict";a.d(s,{cn:function(){return l}});var t=a(1994),r=a(3335);function l(){for(var e=arguments.length,s=Array(e),a=0;a<e;a++)s[a]=arguments[a];return(0,r.m6)((0,t.W)(s))}},1606:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return ew}});var t=a(7437),r=a(2265),l=a(9625),i=a(6885);let n=(0,l.Ue)()((0,i.tJ)((e,s)=>({currentStep:"input",biomarkers:[],questionnaire:{full_name:"",email_address:"",phone_number:"",country:"",state_province:"",date_of_birth:"",biological_sex:"",height:{Feet:"",Inches:""},weight:"",sleep_hours_nightly:"",sleep_quality_rating:5,alcohol_drinks_weekly:"",tobacco_use:"",stress_level_rating:5,vigorous_exercise_days:"",current_medications:"",long_term_medications:[],chronic_conditions:[],medical_conditions:[],current_symptoms:[],regular_migraines:""},isLoading:!1,errors:{},setCurrentStep:s=>{console.debug("Health wizard: Setting step to",s),e({currentStep:s})},addBiomarkers:a=>{let t=s().biomarkers,r=a.map(e=>({...e,status:"raw"}));console.debug("Health wizard: Adding biomarkers",{existing:t.length,new:r.length,total:t.length+r.length}),e({biomarkers:[...t,...r]})},updateBiomarker:(a,t)=>{let r=[...s().biomarkers];r[a]={...t,status:"edited"},console.debug("Health wizard: Updating biomarker",{index:a,name:t.name}),e({biomarkers:r})},setQuestionnaire:s=>{console.debug("Health wizard: Setting questionnaire data",{questionCount:Object.keys(s).length}),e({questionnaire:s})},setLoading:s=>e({isLoading:s}),setError:(a,t)=>{e({errors:{...s().errors,[a]:t}})},clearError:a=>{let t={...s().errors};delete t[a],e({errors:t})},canProceed:()=>{let{currentStep:e,biomarkers:a,questionnaire:t}=s();switch(e){case"input":return a.length>0;case"review":return a.every(e=>e.value&&e.name);case"questionnaire":return["full_name","email_address","phone_number","country","date_of_birth","biological_sex","height","weight","sleep_hours_nightly","sleep_quality_rating","alcohol_drinks_weekly","tobacco_use","stress_level_rating","vigorous_exercise_days","current_medications","long_term_medications","chronic_conditions","medical_conditions","current_symptoms","regular_migraines"].every(e=>{let s=t[e];return"height"===e?s&&Object.values(s).some(e=>""!==e&&null!=e):["long_term_medications","chronic_conditions","medical_conditions","current_symptoms"].includes(e)?Array.isArray(s)&&s.length>0:""!==s&&null!=s});case"complete":return!0;default:return!1}},reset:()=>{console.debug("Health wizard: Resetting store"),e({currentStep:"input",biomarkers:[],questionnaire:{},errors:{}})}}),{name:"health-wizard-store",partialize:e=>({currentStep:e.currentStep,biomarkers:e.biomarkers,questionnaire:e.questionnaire}),onRehydrateStorage:()=>e=>{var s;console.debug("Health wizard: Store rehydrated",{step:null==e?void 0:e.currentStep,biomarkerCount:(null==e?void 0:null===(s=e.biomarkers)||void 0===s?void 0:s.length)||0,questionnaireKeys:Object.keys((null==e?void 0:e.questionnaire)||{}).length})}}));var c=a(401);function o(e){let{currentStep:s}=e,a=[{key:"input",label:"Data Input",number:1},{key:"review",label:"Review",number:2},{key:"questionnaire",label:"Questionnaire",number:3},{key:"complete",label:"Complete",number:4}],r=a.findIndex(e=>e.key===s);return(0,t.jsx)("div",{className:"flex items-center justify-center space-x-4 mb-8",children:a.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"\n            w-10 h-10 rounded-full flex items-center justify-center text-sm font-medium\n            transition-colors duration-200\n            ".concat(s<=r?"bg-blue-600 text-white":"bg-gray-200 text-gray-600","\n          "),children:s<r?(0,t.jsx)(c.Z,{className:"h-5 w-5"}):e.number}),(0,t.jsx)("div",{className:"ml-2 text-sm font-medium text-gray-700",children:e.label}),s<a.length-1&&(0,t.jsx)("div",{className:"\n              w-16 h-0.5 mx-4 transition-colors duration-200\n              ".concat(s<r?"bg-blue-600":"bg-gray-200","\n            ")})]},e.key))})}var d=a(2595);function m(e){let{isLoading:s=!1}=e,{currentStep:a,canProceed:l,setCurrentStep:i}=n(),[c,o]=(0,r.useState)(!1);(0,r.useEffect)(()=>{o(!0)},[]);let m=e=>{switch(e){case"input":return"review";case"review":return"questionnaire";case"questionnaire":return"complete";default:return null}},u=e=>{switch(e){case"review":return"input";case"questionnaire":return"review";case"complete":return"questionnaire";default:return null}},x="input"!==a,h="complete"===a;return(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)(d.z,{variant:"outline",onClick:()=>{let e=u(a);e&&i(e)},disabled:!x||s,className:"min-w-[100px]",children:"Back"}),(0,t.jsxs)("div",{className:"text-sm text-gray-500",children:["input"===a&&"Upload or enter your lab results to continue","review"===a&&"Review and confirm your biomarker data","questionnaire"===a&&"Complete the lifestyle questionnaire","complete"===a&&"Ready to start your health analysis"]}),(0,t.jsx)(d.z,{onClick:()=>{let e=m(a);e&&i(e)},disabled:!c||!l()||s,className:"min-w-[120px] bg-blue-600 hover:bg-blue-700",children:s?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):h?"Start Analysis":"Continue"})]})}var u=a(4029),x=a(7265),h=a(2207),p=a(1671),g=a(5598),j=a(7689),y=a(8736),b=a(9322),f=a(9658),v=a(2489);function N(e){let{onFileSelect:s,onFileRemove:a,onFileParse:l,onError:i,maxSize:n=10485760,acceptedTypes:c=[".pdf",".txt",".json",".csv"],disabled:o=!1}=e,[m,x]=(0,r.useState)(!1),[h,p]=(0,r.useState)(null),[N,w]=(0,r.useState)(null),k=(0,r.useCallback)(e=>{let a=e[0];a&&(p(null),w(a),console.log("FileDropzone: Accepted file:",{name:a.name,type:a.type,size:a.size}),s(a))},[s]),_=(0,r.useCallback)(()=>{w(null),null==a||a()},[a]),C=(0,r.useCallback)(()=>{N&&(null==l||l(N))},[N,l]),L=(0,r.useCallback)(e=>{var s,a;let t=e[0];if((null===(s=t.errors[0])||void 0===s?void 0:s.code)==="file-too-large"){let e="File too large. Maximum size is ".concat(Math.round(n/1024/1024),"MB");p(e),null==i||i(e)}else if((null===(a=t.errors[0])||void 0===a?void 0:a.code)==="file-invalid-type"){let e="Invalid file type. Accepted types: ".concat(c.join(", "));p(e),null==i||i(e)}},[n,c,i]),{getRootProps:S,getInputProps:q,isDragReject:T}=(0,g.uI)({onDrop:k,onDropRejected:L,accept:{"application/pdf":[".pdf"],"text/plain":[".txt"],"text/csv":[".csv"],"application/json":[".json"]},maxSize:n,multiple:!1,disabled:o});return(0,t.jsx)(u.Zb,{className:"w-full",children:(0,t.jsxs)(u.aY,{className:"p-6",children:[(0,t.jsxs)("div",{...S(),className:"\n            border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors\n            ".concat(m?"border-primary bg-primary/5":"border-border hover:border-primary/50","\n            ").concat(T?"border-destructive bg-destructive/5":"","\n            ").concat(o?"opacity-50 cursor-not-allowed":"","\n          "),onMouseEnter:()=>x(!0),onMouseLeave:()=>x(!1),children:[(0,t.jsx)("input",{...q(),id:"file-upload",name:"file",autoComplete:"off"}),(0,t.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,t.jsx)("div",{className:"p-3 bg-primary/10 rounded-full",children:(0,t.jsx)(j.Z,{className:"h-8 w-8 text-primary"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-foreground",children:"Drop your lab report here"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"or click to browse files"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-xs text-muted-foreground",children:[(0,t.jsx)(y.Z,{className:"h-4 w-4"}),(0,t.jsxs)("span",{children:["PDF, TXT, JSON, CSV up to ",Math.round(n/1024/1024),"MB"]})]})]})]}),h&&(0,t.jsxs)("div",{className:"mt-4 flex items-center space-x-2 text-destructive text-sm",children:[(0,t.jsx)(b.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:h})]}),N&&(0,t.jsx)("div",{className:"mt-4 p-4 border border-border rounded-lg bg-muted/50",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"p-2 bg-primary/10 rounded-full",children:(0,t.jsx)(f.Z,{className:"h-5 w-5 text-primary"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-foreground",children:N.name}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:[N.type," • ",(N.size/1024/1024).toFixed(2)," MB"]})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:["application/pdf"===N.type&&(0,t.jsx)(d.z,{onClick:C,size:"sm",className:"bg-primary hover:bg-primary/90",children:"Parse"}),(0,t.jsxs)(d.z,{onClick:_,variant:"outline",size:"sm",className:"text-destructive hover:text-destructive hover:bg-destructive/10",children:[(0,t.jsx)(v.Z,{className:"h-4 w-4 mr-1"}),"Remove"]})]})]})})]})})}var w=a(2835);let k=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("textarea",{className:(0,w.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:s,...r})});k.displayName="Textarea";var _=a(8867);function C(e){let{onTextSubmit:s,onError:a,disabled:l=!1,placeholder:i="Paste your lab results here...\n\nExample:\nTotal Cholesterol: 180 mg/dL\nHDL Cholesterol: 45 mg/dL\nLDL Cholesterol: 110 mg/dL\nTriglycerides: 125 mg/dL"}=e,[n,c]=(0,r.useState)(""),[o,m]=(0,r.useState)(null),x=async()=>{try{let e=await navigator.clipboard.readText();c(e),m(null)}catch(s){let e="Unable to access clipboard. Please paste manually";m(e),null==a||a(e)}};return(0,t.jsxs)(u.Zb,{className:"w-full",children:[(0,t.jsx)(u.Ol,{children:(0,t.jsxs)(u.ll,{className:"flex items-center space-x-2",children:[(0,t.jsx)(_.Z,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:"Paste Lab Results"})]})}),(0,t.jsxs)(u.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(k,{id:"lab-results-text",name:"labResults",value:n,onChange:e=>{c(e.target.value),m(null)},placeholder:i,disabled:l,className:"min-h-[200px] resize-none",autoComplete:"off"}),(0,t.jsxs)("div",{className:"flex justify-between items-center text-xs text-muted-foreground",children:[(0,t.jsxs)("span",{children:[n.length," characters"]}),(0,t.jsx)("span",{children:"Minimum 10 characters required"})]})]}),o&&(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-destructive text-sm",children:[(0,t.jsx)(b.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:o})]}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)(d.z,{onClick:()=>{let e=n.trim();if(!e){let e="Please paste some lab results text before submitting";m(e),null==a||a(e);return}if(e.length<10){let e="Text appears too short. Please paste more detailed lab results";m(e),null==a||a(e);return}m(null),s(e)},disabled:l||!n.trim(),className:"flex-1",children:"Parse Lab Results"}),(0,t.jsx)(d.z,{onClick:x,variant:"outline",disabled:l,children:"Paste from Clipboard"}),(0,t.jsx)(d.z,{onClick:()=>{c(""),m(null)},variant:"outline",disabled:l||!n,children:"Clear"})]})]})]})}let L=r.forwardRef((e,s)=>{let{className:a="",type:r="text",...l}=e;return(0,t.jsx)("input",{type:r,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 ".concat(a),ref:s,...l})});function S(e){let{className:s="",children:a,...r}=e;return(0,t.jsx)("label",{className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 ".concat(s),...r,children:a})}L.displayName="Input";var q=a(7709),T=a(875),F=a(2135);let Z=q.fC;q.ZA;let z=q.B4,A=r.forwardRef((e,s)=>{let{className:a,children:r,...l}=e;return(0,t.jsxs)(q.xz,{ref:s,className:(0,w.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...l,children:[r,(0,t.jsx)(q.JO,{asChild:!0,children:(0,t.jsx)(T.Z,{className:"h-4 w-4 opacity-50"})})]})});A.displayName=q.xz.displayName;let R=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(q.u_,{ref:s,className:(0,w.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,t.jsx)(F.Z,{className:"h-4 w-4"})})});R.displayName=q.u_.displayName;let P=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(q.$G,{ref:s,className:(0,w.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,t.jsx)(T.Z,{className:"h-4 w-4"})})});P.displayName=q.$G.displayName;let H=r.forwardRef((e,s)=>{let{className:a,children:r,position:l="popper",...i}=e;return(0,t.jsx)(q.h_,{children:(0,t.jsxs)(q.VY,{ref:s,className:(0,w.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:l,...i,children:[(0,t.jsx)(R,{}),(0,t.jsx)(q.l_,{className:(0,w.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,t.jsx)(P,{})]})})});H.displayName=q.VY.displayName,r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(q.__,{ref:s,className:(0,w.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...r})}).displayName=q.__.displayName;let O=r.forwardRef((e,s)=>{let{className:a,children:r,...l}=e;return(0,t.jsxs)(q.ck,{ref:s,className:(0,w.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...l,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(q.wU,{children:(0,t.jsx)(c.Z,{className:"h-4 w-4"})})}),(0,t.jsx)(q.eT,{children:r})]})});function B(e){let{variant:s="default",className:a="",children:r,...l}=e;return(0,t.jsx)("div",{role:"alert",className:"relative w-full rounded-lg border p-4 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7 ".concat({default:"bg-background text-foreground border",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}[s]," ").concat(a),...l,children:r})}function D(e){let{className:s="",children:a,...r}=e;return(0,t.jsx)("div",{className:"text-sm [&_p]:leading-relaxed ".concat(s),...r,children:a})}O.displayName=q.ck.displayName,r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(q.Z0,{ref:s,className:(0,w.cn)("-mx-1 my-1 h-px bg-muted",a),...r})}).displayName=q.Z0.displayName;var E=a(1098),I=a(91),U=a(9397),Y=a(8930);let V={glucose:{name:"Glucose",units:["mg/dL","mmol/L"],category:"metabolic"},hba1c:{name:"HbA1c",units:["%","mmol/mol"],category:"metabolic"},insulin:{name:"Insulin",units:["μU/mL","pmol/L"],category:"metabolic"},c_peptide:{name:"C-Peptide",units:["ng/mL","nmol/L"],category:"metabolic"},total_cholesterol:{name:"Total Cholesterol",units:["mg/dL","mmol/L"],category:"cardiovascular"},ldl_cholesterol:{name:"LDL Cholesterol",units:["mg/dL","mmol/L"],category:"cardiovascular"},hdl_cholesterol:{name:"HDL Cholesterol",units:["mg/dL","mmol/L"],category:"cardiovascular"},triglycerides:{name:"Triglycerides",units:["mg/dL","mmol/L"],category:"cardiovascular"},apolipoprotein_b:{name:"Apolipoprotein B",units:["mg/dL","g/L"],category:"cardiovascular"},apolipoprotein_a1:{name:"Apolipoprotein A1",units:["mg/dL","g/L"],category:"cardiovascular"},crp:{name:"C-Reactive Protein (CRP)",units:["mg/L","mg/dL"],category:"inflammatory"},esr:{name:"Erythrocyte Sedimentation Rate (ESR)",units:["mm/hr"],category:"inflammatory"},il_6:{name:"Interleukin-6 (IL-6)",units:["pg/mL","ng/L"],category:"inflammatory"},tnf_alpha:{name:"TNF-α",units:["pg/mL","ng/L"],category:"inflammatory"},creatinine:{name:"Creatinine",units:["mg/dL","μmol/L"],category:"organ"},bun:{name:"Blood Urea Nitrogen (BUN)",units:["mg/dL","mmol/L"],category:"organ"},alt:{name:"ALT (Alanine Aminotransferase)",units:["U/L"],category:"organ"},ast:{name:"AST (Aspartate Aminotransferase)",units:["U/L"],category:"organ"},ggt:{name:"GGT (Gamma-Glutamyl Transferase)",units:["U/L"],category:"organ"},alkaline_phosphatase:{name:"Alkaline Phosphatase",units:["U/L"],category:"organ"},hemoglobin:{name:"Hemoglobin",units:["g/dL","g/L"],category:"cbc"},hematocrit:{name:"Hematocrit",units:["%","L/L"],category:"cbc"},wbc:{name:"White Blood Cell Count",units:["K/μL","\xd710⁹/L"],category:"cbc"},rbc:{name:"Red Blood Cell Count",units:["M/μL","\xd710\xb9\xb2/L"],category:"cbc"},platelets:{name:"Platelet Count",units:["K/μL","\xd710⁹/L"],category:"cbc"},tsh:{name:"TSH (Thyroid Stimulating Hormone)",units:["mIU/L","μIU/mL"],category:"hormonal"},free_t4:{name:"Free T4",units:["ng/dL","pmol/L"],category:"hormonal"},free_t3:{name:"Free T3",units:["pg/mL","pmol/L"],category:"hormonal"},cortisol:{name:"Cortisol",units:["μg/dL","nmol/L"],category:"hormonal"},testosterone:{name:"Testosterone",units:["ng/dL","nmol/L"],category:"hormonal"},vitamin_d:{name:"Vitamin D (25-OH)",units:["ng/mL","nmol/L"],category:"nutritional"},vitamin_b12:{name:"Vitamin B12",units:["pg/mL","pmol/L"],category:"nutritional"},folate:{name:"Folate",units:["ng/mL","nmol/L"],category:"nutritional"},iron:{name:"Iron",units:["μg/dL","μmol/L"],category:"nutritional"},ferritin:{name:"Ferritin",units:["ng/mL","μg/L"],category:"nutritional"}},M={metabolic:"Metabolic Health",cardiovascular:"Cardiovascular Health",inflammatory:"Inflammatory Health",organ:"Organ Function",cbc:"Complete Blood Count",hormonal:"Hormonal Health",nutritional:"Nutritional Status"};function G(e){let{onSubmit:s,onCancel:a,isLoading:l=!1,showSubmitButton:i=!0}=e,[n,c]=(0,r.useState)([]),[o,m]=(0,r.useState)({}),[x,h]=(0,r.useState)("manual"),[g,y]=(0,r.useState)(""),b=()=>{c([...n,{id:"",value:0,unit:"",date:new Date().toISOString().split("T")[0]}])},f=e=>{c(n.filter((s,a)=>a!==e))},v=(e,s,a)=>{let t=[...n];t[e]={...t[e],[s]:a},c(t),o["biomarker_".concat(e)]&&m(s=>{let a={...s};return delete a["biomarker_".concat(e)],a})},N=()=>{let e={};return n.forEach((s,a)=>{s.id||(e["biomarker_".concat(a)]="Please select a biomarker"),(!s.value||s.value<=0)&&(e["biomarker_".concat(a)]="Please enter a valid value"),s.unit||(e["biomarker_".concat(a)]="Please select a unit")}),m(e),0===Object.keys(e).length},w=e=>{let s=e.split("\n").filter(e=>e.trim());s[0].split(",").map(e=>e.trim().toLowerCase());let a=[];for(let e=1;e<s.length;e++){let t=s[e].split(",").map(e=>e.trim());if(t.length>=2){let e=t[0].toLowerCase().replace(/[^a-z0-9_]/g,"_"),s=parseFloat(t[1]),r=t[2]||"",l=t[3]||new Date().toISOString().split("T")[0];isNaN(s)||a.push({id:e,value:s,unit:r,date:l})}}c(a)},k=(()=>{let e={};return Object.entries(V).forEach(s=>{let[a,t]=s;e[t.category]||(e[t.category]=[]),e[t.category].push(a)}),e})();return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)(E.mQ,{value:x,onValueChange:h,children:[(0,t.jsxs)(E.dr,{className:"grid w-full grid-cols-2",children:[(0,t.jsxs)(E.SP,{value:"manual",className:"flex items-center gap-2",children:[(0,t.jsx)(I.Z,{className:"h-4 w-4"}),"Manual Entry"]}),(0,t.jsxs)(E.SP,{value:"upload",className:"flex items-center gap-2",children:[(0,t.jsx)(j.Z,{className:"h-4 w-4"}),"CSV Upload"]})]}),(0,t.jsxs)(E.nU,{value:"manual",className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"Enter Biomarker Values"}),(0,t.jsxs)(d.z,{onClick:b,size:"sm",className:"flex items-center gap-2",children:[(0,t.jsx)(U.Z,{className:"h-4 w-4"}),"Add Biomarker"]})]}),0===n.length?(0,t.jsx)(u.Zb,{className:"border-dashed",children:(0,t.jsx)(u.aY,{className:"pt-6",children:(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(I.Z,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-500 mb-4",children:"No biomarkers added yet"}),(0,t.jsx)(d.z,{onClick:b,variant:"outline",children:"Add Your First Biomarker"})]})})}):(0,t.jsx)("div",{className:"space-y-4",children:n.map((e,s)=>{var a;return(0,t.jsx)(u.Zb,{className:"border-l-4 border-l-blue-500",children:(0,t.jsxs)(u.aY,{className:"pt-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(S,{htmlFor:"biomarker-".concat(s),children:"Biomarker"}),(0,t.jsxs)(Z,{value:e.id,onValueChange:e=>v(s,"id",e),children:[(0,t.jsx)(A,{children:(0,t.jsx)(z,{placeholder:"Select biomarker"})}),(0,t.jsx)(H,{className:"max-h-60",children:Object.entries(k).map(e=>{let[s,a]=e;return(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"px-2 py-1 text-xs font-semibold text-gray-500 bg-gray-50",children:M[s]}),a.map(e=>{var s;return(0,t.jsx)(O,{value:e,children:null===(s=V[e])||void 0===s?void 0:s.name},e)})]},s)})})]}),o["biomarker_".concat(s)]&&(0,t.jsx)("p",{className:"text-xs text-red-500 mt-1",children:o["biomarker_".concat(s)]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(S,{htmlFor:"value-".concat(s),children:"Value"}),(0,t.jsx)(L,{id:"value-".concat(s),type:"number",step:"0.01",value:e.value||"",onChange:e=>v(s,"value",parseFloat(e.target.value)),placeholder:"Enter value"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(S,{htmlFor:"unit-".concat(s),children:"Unit"}),(0,t.jsxs)(Z,{value:e.unit,onValueChange:e=>v(s,"unit",e),children:[(0,t.jsx)(A,{children:(0,t.jsx)(z,{placeholder:"Select unit"})}),(0,t.jsx)(H,{children:e.id&&(null===(a=V[e.id])||void 0===a?void 0:a.units.map(e=>(0,t.jsx)(O,{value:e,children:e},e)))})]})]}),(0,t.jsx)("div",{className:"flex items-end",children:(0,t.jsx)(d.z,{type:"button",variant:"outline",size:"sm",onClick:()=>f(s),className:"text-red-600 hover:text-red-700",children:(0,t.jsx)(Y.Z,{className:"h-4 w-4"})})})]}),(0,t.jsxs)("div",{className:"mt-3",children:[(0,t.jsx)(S,{htmlFor:"date-".concat(s),children:"Date (Optional)"}),(0,t.jsx)(L,{id:"date-".concat(s),type:"date",value:e.date||"",onChange:e=>v(s,"date",e.target.value),className:"max-w-xs"})]})]})},s)})})]}),(0,t.jsx)(E.nU,{value:"upload",className:"space-y-4",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Upload CSV File"}),(0,t.jsx)(u.Zb,{className:"border-dashed",children:(0,t.jsx)(u.aY,{className:"pt-6",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(j.Z,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:"Upload a CSV file with your biomarker data. Format: biomarker_id, value, unit, date"}),(0,t.jsx)("input",{type:"file",accept:".csv",onChange:e=>{var s;let a=null===(s=e.target.files)||void 0===s?void 0:s[0];if(!a)return;let t=new FileReader;t.onload=e=>{var s;let a=null===(s=e.target)||void 0===s?void 0:s.result;y(a),w(a)},t.readAsText(a)},className:"hidden",id:"csv-upload"}),(0,t.jsx)(S,{htmlFor:"csv-upload",children:(0,t.jsx)(d.z,{variant:"outline",onClick:()=>{var e;return null===(e=document.getElementById("csv-upload"))||void 0===e?void 0:e.click()},children:"Choose CSV File"})})]})})}),g&&(0,t.jsxs)(B,{children:[(0,t.jsx)(p.Z,{className:"h-4 w-4"}),(0,t.jsxs)(D,{children:["CSV file processed. ",n.length," biomarkers loaded."]})]})]})})]}),i&&(0,t.jsxs)("div",{className:"flex justify-between pt-6",children:[(0,t.jsx)(d.z,{variant:"outline",onClick:a,disabled:l,children:"Cancel"}),(0,t.jsx)(d.z,{onClick:()=>{N()&&s(n.reduce((e,s)=>(e[s.id]={value:s.value,unit:s.unit,date:s.date},e),{}))},disabled:l||0===n.length,className:"bg-blue-600 hover:bg-blue-700",children:l?"Processing...":"Submit ".concat(n.length," Biomarkers")})]})]})}let Q=a(5566).env.NEXT_PUBLIC_API_URL||"http://localhost:8000";function W(){let[e,s]=(0,r.useState)(null),{addBiomarkers:a,setCurrentStep:l,setError:i,clearError:c,currentStep:o}=n(),[m,g]=(0,r.useState)(!1),j=async e=>{c("upload"),console.log("DataInputStep: File upload received:",{name:e.name,type:e.type,size:e.size})},y=async e=>{c("upload"),console.log("DataInputStep: Parsing file:",{name:e.name,type:e.type,size:e.size}),g(!0);try{console.log("DataInputStep: Sending file to backend for Gemini parsing");let s=new FormData;s.append("file",e);let t=await fetch("".concat(Q,"/api/upload/parse"),{method:"POST",body:s});if(!t.ok){let e=await t.json().catch(()=>({}));throw Error(e.detail||"HTTP ".concat(t.status,": ").concat(t.statusText))}let r=await t.json();if(console.log("DataInputStep: Parsing successful:",r),!r.success)throw Error(r.message||"Parsing failed");let i=r.parsed_data.biomarkers.map(e=>({...e,status:"raw"}));console.log("DataInputStep: Extracted biomarkers:",i),a(i),console.log("DataInputStep: Proceeding to review step"),l("review")}catch(e){console.error("DataInputStep: Error during parsing:",e),i("upload","Error during parsing: ".concat(e instanceof Error?e.message:"Unknown error"))}finally{g(!1)}},b=async e=>{c("paste"),console.log("Text paste:",e)};return"upload"===e?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Upload Your Lab Report"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Upload a PDF or image of your lab results"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)(u.Zb,{children:[(0,t.jsx)(u.Ol,{children:(0,t.jsxs)(u.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(x.Z,{className:"h-5 w-5"}),"Upload File"]})}),(0,t.jsx)(u.aY,{children:(0,t.jsx)(N,{onFileSelect:j,onFileRemove:()=>{c("upload"),console.log("DataInputStep: File removed")},onFileParse:y,onError:e=>i("upload",e)})})]}),(0,t.jsxs)(u.Zb,{children:[(0,t.jsx)(u.Ol,{children:(0,t.jsxs)(u.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(h.Z,{className:"h-5 w-5"}),"Paste Results"]})}),(0,t.jsx)(u.aY,{children:(0,t.jsx)(C,{onTextSubmit:b,onError:e=>i("paste",e)})})]})]}),m&&(0,t.jsx)("div",{className:"text-center p-4",children:(0,t.jsxs)("div",{className:"inline-flex items-center space-x-2",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary"}),(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Parsing file with Gemini AI..."})]})}),(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)(d.z,{variant:"outline",onClick:()=>s(null),children:"Back to Options"})})]}):"manual"===e?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Manual Biomarker Entry"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Enter your biomarker values directly"})]}),(0,t.jsx)(G,{onSubmit:e=>{a(Object.entries(e).map(e=>{let[s,a]=e;return{name:s,value:a,unit:"mg/dL",status:"raw"}})),setTimeout(()=>{l("review")},0)},isLoading:!1,showSubmitButton:!0}),(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)(d.z,{variant:"outline",onClick:()=>s(null),children:"Back to Options"})})]}):(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"How would you like to provide your health data?"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Choose the method that works best for you"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)(u.Zb,{className:"cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>s("upload"),children:[(0,t.jsx)(u.Ol,{children:(0,t.jsxs)(u.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(x.Z,{className:"h-6 w-6 text-blue-600"}),"Upload Lab Report"]})}),(0,t.jsxs)(u.aY,{children:[(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:"Upload a PDF or image of your lab results. We'll automatically extract and parse your biomarker values."}),(0,t.jsxs)("div",{className:"flex items-center text-sm text-green-600",children:[(0,t.jsx)(p.Z,{className:"h-4 w-4 mr-1"}),"Fastest option"]})]})]}),(0,t.jsxs)(u.Zb,{className:"cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>s("manual"),children:[(0,t.jsx)(u.Ol,{children:(0,t.jsxs)(u.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(h.Z,{className:"h-6 w-6 text-green-600"}),"Manual Entry"]})}),(0,t.jsxs)(u.aY,{children:[(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:"Enter your biomarker values manually. Perfect if you have your results in a different format."}),(0,t.jsxs)("div",{className:"flex items-center text-sm text-blue-600",children:[(0,t.jsx)(p.Z,{className:"h-4 w-4 mr-1"}),"Full control"]})]})]})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Don't have your lab results? You can skip this step and complete the questionnaire only."}),(0,t.jsx)(d.z,{variant:"ghost",onClick:()=>l("questionnaire"),className:"mt-2",children:"Skip to Questionnaire"})]})]})}var J=a(1875);let K=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{className:"relative w-full overflow-auto",children:(0,t.jsx)("table",{ref:s,className:(0,w.cn)("w-full caption-bottom text-sm",a),...r})})});K.displayName="Table";let X=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("thead",{ref:s,className:(0,w.cn)("[&_tr]:border-b",a),...r})});X.displayName="TableHeader";let $=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("tbody",{ref:s,className:(0,w.cn)("[&_tr:last-child]:border-0",a),...r})});$.displayName="TableBody",r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("tfoot",{ref:s,className:(0,w.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...r})}).displayName="TableFooter";let ee=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("tr",{ref:s,className:(0,w.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...r})});ee.displayName="TableRow";let es=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("th",{ref:s,className:(0,w.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...r})});es.displayName="TableHead";let ea=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("td",{ref:s,className:(0,w.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...r})});ea.displayName="TableCell",r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("caption",{ref:s,className:(0,w.cn)("mt-4 text-sm text-muted-foreground",a),...r})}).displayName="TableCaption";var et=a(5868),er=a(3229);let el=["mg/dL","mmol/L","ng/mL","pg/mL","IU/mL","U/L","g/dL","%","cells/μL","mg/L","μg/dL","mEq/L","ng/dL","pmol/L"],ei=["Total Cholesterol","HDL Cholesterol","LDL Cholesterol","Triglycerides","Glucose","HbA1c","Insulin","C-Reactive Protein","ESR","Ferritin","Vitamin D","B12","Folate","TSH","T4","T3","Creatinine","BUN","ALT","AST","GGT","ALP","Bilirubin","Albumin","Hemoglobin","Hematocrit","WBC","RBC","Platelets","Sodium","Potassium","Chloride","CO2","Calcium","Phosphorus","Magnesium"];function en(e){let{biomarker:s,isOpen:a,onSave:l,onCancel:i}=e,[n,c]=(0,r.useState)({name:"",value:"",unit:"",status:"edited"}),[o,m]=(0,r.useState)({});(0,r.useEffect)(()=>{s&&(c({name:s.name,value:s.value.toString(),unit:s.unit,status:s.status||"edited"}),m({}))},[s]);let x=()=>{let e={};if(n.name.trim()||(e.name="Biomarker name is required"),n.value.trim()){let s=parseFloat(n.value);isNaN(s)?e.value="Value must be a valid number":s<0&&(e.value="Value must be positive")}else e.value="Value is required";return n.unit.trim()||(e.unit="Unit is required"),m(e),0===Object.keys(e).length};return a&&s?(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,t.jsxs)(u.Zb,{className:"w-full max-w-md max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)(u.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-4",children:[(0,t.jsx)(u.ll,{children:"Edit Biomarker"}),(0,t.jsx)(d.z,{variant:"ghost",size:"sm",onClick:i,children:(0,t.jsx)(v.Z,{className:"h-4 w-4"})})]}),(0,t.jsxs)(u.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S,{htmlFor:"name",children:"Biomarker Name"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(Z,{onValueChange:e=>{c(s=>({...s,name:e}))},value:n.name,children:[(0,t.jsx)(A,{children:(0,t.jsx)(z,{placeholder:"Select or type biomarker name"})}),(0,t.jsx)(H,{children:ei.map(e=>(0,t.jsx)(O,{value:e,children:e},e))})]}),(0,t.jsx)(L,{id:"name",value:n.name,onChange:e=>c(s=>({...s,name:e.target.value})),placeholder:"Enter biomarker name",className:o.name?"border-red-500":""})]}),o.name&&(0,t.jsxs)("div",{className:"flex items-center space-x-1 text-destructive text-sm",children:[(0,t.jsx)(b.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:o.name})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S,{htmlFor:"value",children:"Value"}),(0,t.jsx)(L,{id:"value",type:"number",step:"any",value:n.value,onChange:e=>c(s=>({...s,value:e.target.value})),placeholder:"Enter value",className:o.value?"border-red-500":""}),o.value&&(0,t.jsxs)("div",{className:"flex items-center space-x-1 text-destructive text-sm",children:[(0,t.jsx)(b.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:o.value})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S,{htmlFor:"unit",children:"Unit"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(Z,{onValueChange:e=>c(s=>({...s,unit:e})),value:n.unit,children:[(0,t.jsx)(A,{children:(0,t.jsx)(z,{placeholder:"Select unit"})}),(0,t.jsx)(H,{children:el.map(e=>(0,t.jsx)(O,{value:e,children:e},e))})]}),(0,t.jsx)(L,{id:"unit",value:n.unit,onChange:e=>c(s=>({...s,unit:e.target.value})),placeholder:"Enter unit",className:o.unit?"border-red-500":""})]}),o.unit&&(0,t.jsxs)("div",{className:"flex items-center space-x-1 text-destructive text-sm",children:[(0,t.jsx)(b.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:o.unit})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S,{children:"Status"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(J.C,{variant:"default",children:"Edited"}),(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"This biomarker has been modified from the original"})]})]}),(0,t.jsxs)("div",{className:"flex space-x-2 pt-4",children:[(0,t.jsxs)(d.z,{onClick:()=>{if(!x())return;let e=parseFloat(n.value);l({name:n.name.trim(),value:isNaN(e)?n.value:e,unit:n.unit.trim(),status:"edited"})},className:"flex-1",children:[(0,t.jsx)(er.Z,{className:"h-4 w-4 mr-2"}),"Save Changes"]}),(0,t.jsx)(d.z,{onClick:i,variant:"outline",className:"flex-1",children:"Cancel"})]})]})]})}):null}function ec(e){let{biomarkers:s,onBiomarkerEdit:a,onConfirmAll:l,isLoading:i=!1,error:n=null}=e,[o,m]=(0,r.useState)(null),x=e=>{switch(e){case"Low":return(0,t.jsx)(J.C,{variant:"outline",className:"rounded-md px-2 py-1 text-sm font-medium text-yellow-600 border-yellow-600 bg-yellow-50",children:"Low"});case"High":return(0,t.jsx)(J.C,{variant:"outline",className:"rounded-md px-2 py-1 text-sm font-medium text-red-600 border-red-600 bg-red-50",children:"High"});case"Normal":return(0,t.jsx)(J.C,{variant:"outline",className:"rounded-md px-2 py-1 text-sm font-medium text-green-600 border-green-600 bg-green-50",children:"Normal"});default:return(0,t.jsx)(J.C,{variant:"outline",className:"rounded-md px-2 py-1 text-sm font-medium text-gray-600 border-gray-600 bg-gray-50",children:"Unknown"})}},h=e=>{m(e)},p=s.length>0,g=0===s.length;return n?(0,t.jsx)(u.Zb,{className:"w-full",children:(0,t.jsx)(u.aY,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-destructive",children:[(0,t.jsx)(b.Z,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:n})]})})}):0===s.length?(0,t.jsx)(u.Zb,{className:"w-full",children:(0,t.jsx)(u.aY,{className:"p-6 text-center text-muted-foreground",children:"No biomarkers found. Please upload or paste lab results to get started."})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(u.Zb,{className:"w-full",children:[(0,t.jsx)(u.Ol,{children:(0,t.jsxs)(u.ll,{className:"flex items-center justify-between",children:[(0,t.jsxs)("span",{children:["Parsed Biomarkers (",s.length,")"]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[g&&(0,t.jsx)(J.C,{variant:"outline",className:"text-[hsl(var(--status-fair))] border-[hsl(var(--status-fair))]",children:"Review Required"}),p&&(0,t.jsx)(J.C,{variant:"outline",className:"text-[hsl(var(--status-excellent))] border-[hsl(var(--status-excellent))]",children:"All Confirmed"})]})]})}),(0,t.jsxs)(u.aY,{children:[(0,t.jsx)("div",{className:"rounded-md border",children:(0,t.jsxs)(K,{children:[(0,t.jsx)(X,{children:(0,t.jsxs)(ee,{children:[(0,t.jsx)(es,{children:"Biomarker"}),(0,t.jsx)(es,{className:"text-right",children:"Value"}),(0,t.jsx)(es,{children:"Unit"}),(0,t.jsx)(es,{children:"Reference Range"}),(0,t.jsx)(es,{children:"Health Status"}),(0,t.jsx)(es,{className:"w-[100px]",children:"Edit"})]})}),(0,t.jsx)($,{children:s.map((e,s)=>(0,t.jsxs)(ee,{children:[(0,t.jsx)(ea,{className:"font-medium",children:e.name}),(0,t.jsx)(ea,{className:"text-right",children:"number"==typeof e.value?e.value.toFixed(2):e.value}),(0,t.jsx)(ea,{children:e.unit}),(0,t.jsx)(ea,{children:e.reference||"—"}),(0,t.jsx)(ea,{children:x(e.healthStatus||"Unknown")}),(0,t.jsx)(ea,{children:(0,t.jsx)(d.z,{variant:"outline",size:"sm",onClick:()=>h(s),disabled:i,children:(0,t.jsx)(et.Z,{className:"h-4 w-4"})})})]},s))})]})}),(0,t.jsx)("div",{className:"mt-4 flex justify-end",children:(0,t.jsx)(d.z,{onClick:l,disabled:i||0===s.length,className:"min-w-[120px]",children:i?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.Z,{className:"h-4 w-4 mr-2"}),"Confirm All"]})})})]})]}),(0,t.jsx)(en,{biomarker:null!==o?s[o]:null,isOpen:null!==o,onSave:e=>{null!==o&&(a(o,e),m(null))},onCancel:()=>{m(null)}})]})}function eo(){let{biomarkers:e,updateBiomarker:s,addBiomarkers:a,setCurrentStep:l}=n(),[i,c]=r.useState(!1),o=e=>{a(Object.entries(e).map(e=>{let[s,a]=e;return{name:s,value:a,unit:"mg/dL",status:"raw"}})),c(!1)},m=()=>{e.forEach((e,a)=>{"confirmed"!==e.status&&s(a,{...e,status:"confirmed"})}),setTimeout(()=>{l("questionnaire")},0)};return 0===e.length?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(U.Z,{className:"h-8 w-8 text-gray-400"})}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No biomarkers found"}),(0,t.jsx)("p",{className:"text-gray-600 mb-6",children:"It looks like no biomarkers were detected. You can add them manually or proceed to the questionnaire."}),(0,t.jsxs)("div",{className:"space-x-4",children:[(0,t.jsxs)(d.z,{onClick:()=>c(!0),children:[(0,t.jsx)(U.Z,{className:"h-4 w-4 mr-2"}),"Add Biomarkers"]}),(0,t.jsx)(d.z,{variant:"outline",onClick:()=>l("questionnaire"),children:"Skip to Questionnaire"})]})]}),i&&(0,t.jsxs)(u.Zb,{children:[(0,t.jsx)(u.Ol,{children:(0,t.jsx)(u.ll,{children:"Add Biomarkers"})}),(0,t.jsxs)(u.aY,{children:[(0,t.jsx)(G,{onSubmit:o,isLoading:!1,showSubmitButton:!0}),(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)(d.z,{variant:"outline",onClick:()=>c(!1),children:"Cancel"})})]})]})]}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Review Your Biomarker Data"}),(0,t.jsxs)("p",{className:"text-gray-600",children:["Found ",e.length," biomarkers. Review and edit as needed, then confirm to continue."]})]}),(0,t.jsx)(ec,{biomarkers:e,onBiomarkerEdit:(e,a)=>{s(e,a)},onConfirmAll:m,isLoading:!1,error:null}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsxs)(d.z,{variant:"outline",onClick:()=>c(!0),className:"mr-4",children:[(0,t.jsx)(U.Z,{className:"h-4 w-4 mr-2"}),"Add More Biomarkers"]}),(0,t.jsxs)(d.z,{onClick:m,className:"bg-green-600 hover:bg-green-700",children:[(0,t.jsx)(p.Z,{className:"h-4 w-4 mr-2"}),"Confirm All & Continue"]})]}),i&&(0,t.jsxs)(u.Zb,{className:"mt-6",children:[(0,t.jsx)(u.Ol,{children:(0,t.jsx)(u.ll,{children:"Add Additional Biomarkers"})}),(0,t.jsxs)(u.aY,{children:[(0,t.jsx)(G,{onSubmit:o,isLoading:!1,showSubmitButton:!0}),(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)(d.z,{variant:"outline",onClick:()=>c(!1),children:"Cancel"})})]})]}),(0,t.jsxs)("div",{className:"text-center pt-4 border-t",children:[(0,t.jsx)("p",{className:"text-sm text-gray-500 mb-2",children:"Don't want to review biomarkers? You can skip to the questionnaire."}),(0,t.jsx)(d.z,{variant:"ghost",onClick:()=>l("questionnaire"),children:"Skip to Questionnaire"})]})]})}var ed=a(2660);function em(e){let{value:s=[0],onValueChange:a,min:r=0,max:l=100,step:i=1,className:n=""}=e;return(0,t.jsx)("div",{className:"relative flex w-full touch-none select-none items-center ".concat(n),children:(0,t.jsx)("input",{type:"range",min:r,max:l,step:i,value:s[0],onChange:e=>{a&&a([parseInt(e.target.value)])},className:"w-full h-2 bg-secondary rounded-lg appearance-none cursor-pointer"})})}function eu(e){let{className:s="",onCheckedChange:a,...r}=e;return(0,t.jsx)("input",{type:"checkbox",className:"h-4 w-4 rounded border border-primary text-primary focus:ring-2 focus:ring-ring focus:ring-offset-2 ".concat(s),onChange:e=>{a&&a(e.target.checked)},...r})}var ex=a(1236),eh=a(1817);function ep(e){let{onSubmit:s,onCancel:a,initialData:l={},isLoading:i=!1}=e,[n,c]=(0,r.useState)([]),[o,m]=(0,r.useState)(()=>({full_name:"",email_address:"",phone_number:"",country:"",state_province:"",date_of_birth:"",biological_sex:"",height:{Feet:"",Inches:""},weight:"",sleep_hours_nightly:"",sleep_quality_rating:5,alcohol_drinks_weekly:"",tobacco_use:"",stress_level_rating:5,vigorous_exercise_days:"",current_medications:"",long_term_medications:[],chronic_conditions:[],medical_conditions:[],current_symptoms:[],regular_migraines:"",...l})),[x,h]=(0,r.useState)(0),[g,j]=(0,r.useState)({}),[y,b]=(0,r.useState)(!1),[f,v]=(0,r.useState)(!0),N=Math.ceil(n.length/5);(0,r.useEffect)(()=>{w()},[]);let w=async()=>{try{c([{id:"full_name",section:"demographics",question:"Full Name",type:"text",required:!0},{id:"email_address",section:"demographics",question:"Email Address",type:"email",required:!0},{id:"phone_number",section:"demographics",question:"Phone Number",type:"phone",required:!0},{id:"country",section:"demographics",question:"Country",type:"dropdown",options:["United Kingdom","United States","Canada","Australia","Other"],required:!0},{id:"state_province",section:"demographics",question:"State/Province",type:"text",required:!1},{id:"date_of_birth",section:"demographics",question:"Date of Birth",type:"date",required:!0},{id:"biological_sex",section:"demographics",question:"Biological Sex",type:"dropdown",options:["Male","Female","Intersex"],required:!0},{id:"height",section:"demographics",question:"Height",type:"group",fields:[{label:"Feet",type:"number",min:3,max:8},{label:"Inches",type:"number",min:0,max:11}],alternativeUnit:{label:"Height (cm)",type:"number",min:100,max:250},required:!0},{id:"weight",section:"demographics",question:"Weight",type:"number",label:"Weight (lbs)",alternativeUnit:{label:"Weight (kg)",type:"number",min:30,max:300},required:!0},{id:"sleep_hours_nightly",section:"lifestyle",question:"How many hours of sleep do you typically get per night?",type:"dropdown",options:["Less than 5 hours","5-6 hours","7-8 hours","9+ hours"],required:!0},{id:"sleep_quality_rating",section:"lifestyle",question:"Rate your sleep quality (1-10)",type:"slider",min:1,max:10,labels:{1:"Wake up exhausted",5:"Somewhat rested",10:"Always refreshed"},required:!0},{id:"alcohol_drinks_weekly",section:"lifestyle",question:"How many alcoholic drinks do you consume per week?",type:"dropdown",options:["None","1-3 drinks","4-7 drinks","8-14 drinks","15+ drinks"],helpText:"1 drink = 12oz beer, 5oz wine, or 1.5oz spirits",required:!0},{id:"tobacco_use",section:"lifestyle",question:"Do you currently use tobacco products?",type:"dropdown",options:["Never used","Former user quit >1 year","Former user quit <1 year","Occasional use","Daily use"],required:!0},{id:"stress_level_rating",section:"lifestyle",question:"Rate your average stress level (1-10)",type:"slider",min:1,max:10,labels:{1:"Very low stress",5:"Moderate stress",10:"Overwhelming stress"},required:!0},{id:"vigorous_exercise_days",section:"lifestyle",question:"How many days per week do you do vigorous exercise (20+ min)?",type:"dropdown",options:["0 days","1 day","2 days","3 days","4+ days"],helpText:"Vigorous = hard breathing and sweating",required:!0},{id:"current_medications",section:"medical_history",question:"Are you currently taking any prescription medications?",type:"dropdown",options:["None","1-2 medications","3-5 medications","6+ medications","Prefer not to say"],required:!0},{id:"long_term_medications",section:"medical_history",question:"Are you currently taking any of the following long-term medications?",type:"checkbox",options:["None","Corticosteroids","Atypical antipsychotics","HIV/AIDS treatments"],required:!0,helpText:"These medications can affect cardiovascular risk assessment"},{id:"chronic_conditions",section:"medical_history",question:"Do you have any diagnosed chronic conditions?",type:"checkbox",options:["None","High blood pressure","High cholesterol","Diabetes Type 1","Diabetes Type 2","Heart disease","Thyroid disorder","Autoimmune condition","Liver disease","Kidney disease","Other"],allowOther:!0,required:!0},{id:"medical_conditions",section:"medical_history",question:"Have you ever been diagnosed with any of the following medical conditions?",type:"checkbox",options:["None","Atrial fibrillation","Rheumatoid arthritis","Systemic lupus erythematosus (SLE)"],required:!0,helpText:"These conditions can affect cardiovascular risk assessment"},{id:"current_symptoms",section:"symptoms",question:"Do you have any current symptoms affecting your daily life?",type:"checkbox",options:["None","Fatigue","Brain fog","Joint pain","Digestive issues","Sleep problems","Mood changes","Other"],allowOther:!0,required:!0},{id:"regular_migraines",section:"symptoms",question:"Do you suffer from regular migraines?",type:"dropdown",options:["Yes","No","Not sure"],required:!0,helpText:"Migraines can be associated with cardiovascular risk factors"}]),v(!1)}catch(e){console.error("Failed to load questions:",e),v(!1)}},_=()=>{let e=5*x;return n.slice(e,e+5)},C=(e,s)=>{m(a=>({...a,[e]:s})),g[e]&&j(s=>{let a={...s};return delete a[e],a})},q=()=>{let e=_(),s={};return e.forEach(e=>{if(e.required){let a=o[e.id];("checkbox"===e.type?Array.isArray(a)&&a.length>0:"group"===e.type?a&&Object.values(a).some(e=>""!==e&&null!=e):""!==a&&null!=a)||(s[e.id]="This field is required")}}),j(s),0===Object.keys(s).length},T=async()=>{if(q()){b(!0);try{await s(o)}catch(e){console.error("Failed to submit questionnaire:",e)}finally{b(!1)}}},F=e=>{var s,a,r;let l=o[e.id],i=g[e.id];switch(e.type){case"text":case"email":case"phone":case"date":return(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(S,{htmlFor:e.id,className:"text-sm font-medium",children:[e.question,e.required&&(0,t.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,t.jsx)(L,{id:e.id,type:e.type,value:null!=l?l:"",onChange:s=>C(e.id,s.target.value),className:i?"border-red-500":""}),e.helpText&&(0,t.jsx)("p",{className:"text-xs text-gray-500",children:e.helpText}),i&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:i})]},e.id);case"number":return(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(S,{htmlFor:e.id,className:"text-sm font-medium",children:[e.question,e.required&&(0,t.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,t.jsx)(L,{id:e.id,type:"number",min:e.min,max:e.max,value:null!=l?l:"",onChange:s=>C(e.id,parseFloat(s.target.value)||0),className:i?"border-red-500":""}),e.helpText&&(0,t.jsx)("p",{className:"text-xs text-gray-500",children:e.helpText}),i&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:i})]},e.id);case"dropdown":return(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(S,{htmlFor:e.id,className:"text-sm font-medium",children:[e.question,e.required&&(0,t.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,t.jsxs)(Z,{value:null!=l?l:"",onValueChange:s=>C(e.id,s),children:[(0,t.jsx)(A,{className:i?"border-red-500":"",children:(0,t.jsx)(z,{placeholder:"Select an option"})}),(0,t.jsx)(H,{children:null===(s=e.options)||void 0===s?void 0:s.map(e=>(0,t.jsx)(O,{value:e,children:e},e))})]}),e.helpText&&(0,t.jsx)("p",{className:"text-xs text-gray-500",children:e.helpText}),i&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:i})]},e.id);case"slider":return(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(S,{htmlFor:e.id,className:"text-sm font-medium",children:[e.question,e.required&&(0,t.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,t.jsxs)("div",{className:"px-3",children:[(0,t.jsx)(em,{min:e.min||1,max:e.max||10,step:1,value:[null!=l?l:e.min||1],onValueChange:s=>C(e.id,s[0]),className:"w-full"}),(0,t.jsx)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:e.labels&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{children:e.labels[String(e.min||1)]}),(0,t.jsx)("span",{children:e.labels[String(e.max||10)]})]})}),(0,t.jsx)("div",{className:"text-center mt-2",children:(0,t.jsx)("span",{className:"text-lg font-semibold",children:null!=l?l:e.min||1})})]}),e.helpText&&(0,t.jsx)("p",{className:"text-xs text-gray-500",children:e.helpText}),i&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:i})]},e.id);case"checkbox":return(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(S,{className:"text-sm font-medium",children:[e.question,e.required&&(0,t.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,t.jsx)("div",{className:"space-y-2",children:null===(a=e.options)||void 0===a?void 0:a.map(s=>(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(eu,{id:"".concat(e.id,"-").concat(s),checked:!!Array.isArray(l)&&l.includes(s),onCheckedChange:a=>{let t=Array.isArray(l)?l:[];a?C(e.id,[...t,s]):C(e.id,t.filter(e=>e!==s))}}),(0,t.jsx)(S,{htmlFor:"".concat(e.id,"-").concat(s),className:"text-sm",children:s})]},s))}),e.helpText&&(0,t.jsx)("p",{className:"text-xs text-gray-500",children:e.helpText}),i&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:i})]},e.id);case"group":return(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(S,{className:"text-sm font-medium",children:[e.question,e.required&&(0,t.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:null===(r=e.fields)||void 0===r?void 0:r.map(s=>{var a;return(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)(S,{htmlFor:"".concat(e.id,"-").concat(s.label),className:"text-xs",children:s.label}),(0,t.jsx)(L,{id:"".concat(e.id,"-").concat(s.label),type:s.type,min:s.min,max:s.max,value:null!==(a=null==l?void 0:l[s.label])&&void 0!==a?a:"",onChange:a=>{let t={...l,[s.label]:"number"===s.type?parseFloat(a.target.value)||0:a.target.value};C(e.id,t)}})]},s.label)})}),e.helpText&&(0,t.jsx)("p",{className:"text-xs text-gray-500",children:e.helpText}),i&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:i})]},e.id);default:return(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(S,{htmlFor:e.id,className:"text-sm font-medium",children:[e.question,e.required&&(0,t.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,t.jsx)(k,{id:e.id,value:null!=l?l:"",onChange:s=>C(e.id,s.target.value),className:i?"border-red-500":""}),e.helpText&&(0,t.jsx)("p",{className:"text-xs text-gray-500",children:e.helpText}),i&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:i})]},e.id)}};return f?(0,t.jsxs)("div",{className:"flex items-center justify-center p-8",children:[(0,t.jsx)(eh.Z,{className:"h-8 w-8 animate-spin"}),(0,t.jsx)("span",{className:"ml-2",children:"Loading questionnaire..."})]}):(_(),(0,t.jsx)("div",{className:"max-w-4xl mx-auto p-6",children:(0,t.jsxs)(u.Zb,{children:[(0,t.jsxs)(u.Ol,{children:[(0,t.jsxs)(u.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(p.Z,{className:"h-5 w-5 text-green-500"}),"Health Assessment Questionnaire"]}),(0,t.jsxs)(u.SZ,{children:["Please complete all required fields to get personalized health insights. Step ",x+1," of ",N]}),(0,t.jsx)(ex.E,{value:(x+1)/N*100,className:"w-full"})]}),(0,t.jsxs)(u.aY,{className:"space-y-6",children:[Object.entries(n.reduce((e,s)=>(e[s.section]||(e[s.section]=[]),e[s.section].push(s),e),{})).map(e=>{let[s,a]=e;return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 capitalize",children:s.replace(/_/g," ")}),(0,t.jsx)("div",{className:"space-y-4 pl-4",children:a.map(F)})]},s)}),(0,t.jsxs)("div",{className:"flex justify-between pt-6",children:[(0,t.jsx)(d.z,{variant:"outline",onClick:0===x?a:()=>{h(e=>Math.max(e-1,0))},disabled:y,children:0===x?"Cancel":"Previous"}),(0,t.jsx)("div",{className:"flex gap-2",children:x<N-1?(0,t.jsx)(d.z,{onClick:()=>{q()&&h(e=>Math.min(e+1,N-1))},disabled:y,children:"Next"}):(0,t.jsx)(d.z,{onClick:T,disabled:y,className:"bg-green-600 hover:bg-green-700",children:y?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eh.Z,{className:"h-4 w-4 animate-spin mr-2"}),"Submitting..."]}):"Complete Assessment"})})]})]})]})}))}function eg(){let{questionnaire:e,setQuestionnaire:s,setCurrentStep:a,biomarkers:l}=n(),[i,c]=r.useState(!1),o=async e=>{c(!0);try{s(e),setTimeout(()=>{a("complete")},0)}catch(e){console.error("Failed to save questionnaire:",e)}finally{c(!1)}},m=l.length>0;return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Lifestyle & Health Habits"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Help us understand your lifestyle for more personalized health insights"})]}),m&&(0,t.jsx)(u.Zb,{className:"bg-green-50 border-green-200",children:(0,t.jsxs)(u.aY,{className:"pt-6",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-green-800",children:[(0,t.jsx)(p.Z,{className:"h-5 w-5"}),(0,t.jsxs)("span",{className:"font-medium",children:[l.length," biomarkers confirmed"]})]}),(0,t.jsx)("p",{className:"text-sm text-green-700 mt-1",children:"Your biomarker data is ready. Now let's learn about your lifestyle to provide better insights."})]})}),(0,t.jsxs)(u.Zb,{children:[(0,t.jsx)(u.Ol,{children:(0,t.jsx)(u.ll,{children:"Health & Lifestyle Questionnaire"})}),(0,t.jsx)(u.aY,{children:(0,t.jsx)(ep,{onSubmit:o,onCancel:()=>a("review"),initialData:e,isLoading:i})})]}),m&&(0,t.jsx)("div",{className:"text-center",children:(0,t.jsxs)(d.z,{variant:"outline",onClick:()=>a("review"),className:"mr-4",children:[(0,t.jsx)(ed.Z,{className:"h-4 w-4 mr-2"}),"Back to Biomarker Review"]})}),(0,t.jsxs)("div",{className:"text-center pt-4 border-t",children:[(0,t.jsx)("p",{className:"text-sm text-gray-500 mb-2",children:"Want to proceed with just your biomarker data? You can skip the questionnaire."}),(0,t.jsx)(d.z,{variant:"ghost",onClick:()=>a("complete"),disabled:i,children:"Skip Questionnaire"})]})]})}var ej=a(3276),ey=a(2430),eb=a(9376),ef=a(5566);function ev(){let{biomarkers:e,questionnaire:s,setCurrentStep:a}=n(),{startAnalysis:l,isLoading:i}=(0,ey._)(),c=(0,eb.useRouter)(),[o,m]=r.useState(!1),[x,h]=r.useState(!1),[g,j]=r.useState(null),y=async()=>{m(!0);try{var a;console.log("AnalysisLaunchStep: Starting analysis with data:",{biomarkers:e.length,questionnaire:Object.keys(s).length});let t=e.reduce((e,s)=>(e[s.name]={value:"number"==typeof s.value?s.value:parseFloat(s.value),unit:s.unit},e),{}),r={user_id:"temp_user_"+Date.now(),age:b(s.date_of_birth)||35,sex:(null===(a=s.biological_sex)||void 0===a?void 0:a.toLowerCase())||"male",height:f(s.height)||180,weight:parseFloat(s.weight)||75,questionnaire:s};console.log("AnalysisLaunchStep: Prepared analysis payload:",{biomarkers:t,user:r});let l=await fetch("".concat(ef.env.NEXT_PUBLIC_API_URL||"http://localhost:8000","/api/analysis/start"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({biomarkers:t,user:r})});if(console.log("AnalysisLaunchStep: API response status:",l.status),!l.ok){let e=await l.json().catch(()=>({}));throw Error(e.detail||"HTTP ".concat(l.status,": ").concat(l.statusText))}let i=await l.json();if(console.log("AnalysisLaunchStep: Analysis started successfully:",i),i.analysis_id)console.log("AnalysisLaunchStep: Redirecting to results page with analysis_id:",i.analysis_id),h(!0),j(i.analysis_id),m(!1),setTimeout(()=>{c.push("/results?analysis_id=".concat(i.analysis_id))},2e3);else throw Error("No analysis_id received from server")}catch(e){console.error("AnalysisLaunchStep: Failed to start analysis:",e)}finally{m(!1)}},b=e=>{if(!e)return null;let s=new Date,a=new Date(e),t=s.getFullYear()-a.getFullYear(),r=s.getMonth()-a.getMonth();return(r<0||0===r&&s.getDate()<a.getDate())&&t--,t},f=e=>{if(!e||"object"!=typeof e)return null;let s=parseFloat(e.Feet)||0,a=parseFloat(e.Inches)||0;return 0===s&&0===a?null:Math.round((12*s+a)*2.54)},v=e.length>0,N=Object.keys(s).length>0;return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(p.Z,{className:"h-8 w-8 text-green-600"})}),(0,t.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Ready for Analysis!"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Your health data is complete. Let's generate your personalized health insights."})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[v&&(0,t.jsx)(u.Zb,{className:"bg-blue-50 border-blue-200",children:(0,t.jsxs)(u.aY,{className:"pt-6",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-blue-800",children:[(0,t.jsx)(p.Z,{className:"h-5 w-5"}),(0,t.jsx)("span",{className:"font-medium",children:"Biomarker Data"})]}),(0,t.jsxs)("p",{className:"text-sm text-blue-700 mt-1",children:[e.length," biomarkers confirmed and ready for analysis"]})]})}),N&&(0,t.jsx)(u.Zb,{className:"bg-green-50 border-green-200",children:(0,t.jsxs)(u.aY,{className:"pt-6",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-green-800",children:[(0,t.jsx)(p.Z,{className:"h-5 w-5"}),(0,t.jsx)("span",{className:"font-medium",children:"Lifestyle Data"})]}),(0,t.jsx)("p",{className:"text-sm text-green-700 mt-1",children:"Health and lifestyle questionnaire completed"})]})})]}),(0,t.jsxs)(u.Zb,{children:[(0,t.jsx)(u.Ol,{children:(0,t.jsx)(u.ll,{children:"What to Expect"})}),(0,t.jsx)(u.aY,{children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-blue-600 rounded-full mt-2"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:"Personalized Health Score"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Overall health assessment based on your biomarkers"})]})]}),(0,t.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-green-600 rounded-full mt-2"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:"Risk Analysis"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Identification of potential health risks and patterns"})]})]}),(0,t.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-purple-600 rounded-full mt-2"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:"Personalized Recommendations"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Actionable insights tailored to your health profile"})]})]})]})})]}),(0,t.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,t.jsxs)(d.z,{variant:"outline",onClick:()=>a("questionnaire"),disabled:o||i,children:[(0,t.jsx)(ed.Z,{className:"h-4 w-4 mr-2"}),"Back to Questionnaire"]}),(0,t.jsx)(d.z,{onClick:y,disabled:o||i||x,className:"bg-blue-600 hover:bg-blue-700 min-w-[160px]",children:x?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.Z,{className:"h-4 w-4 mr-2"}),"Analysis Started!"]}):o||i?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Starting Analysis..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ej.Z,{className:"h-4 w-4 mr-2"}),"Start Analysis"]})})]}),x&&g&&(0,t.jsx)(u.Zb,{className:"bg-green-50 border-green-200",children:(0,t.jsx)(u.aY,{className:"pt-6",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(p.Z,{className:"h-12 w-12 text-green-600 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-green-800 mb-2",children:"Analysis Started Successfully!"}),(0,t.jsx)("p",{className:"text-sm text-green-700 mb-2",children:"Your analysis is now processing. Redirecting to results page..."}),(0,t.jsxs)("p",{className:"text-xs text-green-600 font-mono",children:["Analysis ID: ",g]})]})})}),(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Your analysis will be ready in approximately 2-3 minutes"})})]})}function eN(){let{currentStep:e,errors:s,isLoading:a}=n();return(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto px-4",children:[(0,t.jsxs)("div",{className:"text-center mb-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"\uD83E\uDE7A Health Analysis Setup"}),(0,t.jsx)("p",{className:"text-lg text-gray-600",children:"Get personalized health insights from your lab results"})]}),(0,t.jsx)(o,{currentStep:e}),(0,t.jsxs)(u.Zb,{className:"mb-6",children:[(0,t.jsx)(u.Ol,{children:(0,t.jsxs)(u.ll,{className:"text-center",children:["input"===e&&"Step 1: Your Health Data","review"===e&&"Step 2: Review Your Data","questionnaire"===e&&"Step 3: Lifestyle & Health Habits","complete"===e&&"Ready for Analysis!"]})}),(0,t.jsxs)(u.aY,{children:[Object.keys(s).length>0&&(0,t.jsx)("div",{className:"mb-6 space-y-2",children:Object.entries(s).map(e=>{let[s,a]=e;return(0,t.jsxs)(B,{className:"border-red-200 bg-red-50",children:[(0,t.jsx)(b.Z,{className:"h-4 w-4 text-red-600"}),(0,t.jsx)(D,{className:"text-red-800",children:a})]},s)})}),(()=>{switch(e){case"input":default:return(0,t.jsx)(W,{});case"review":return(0,t.jsx)(eo,{});case"questionnaire":return(0,t.jsx)(eg,{});case"complete":return(0,t.jsx)(ev,{})}})()]})]}),(0,t.jsx)(m,{isLoading:a})]})})}function ew(){return(0,t.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,t.jsx)(eN,{})})}}},function(e){e.O(0,[904,543,457,116,971,117,744],function(){return e(e.s=9089)}),_N_E=e.O()}]);